!function(){let e,i,s,r,a,o,l,h,u,c,d,p,f,m,_,g,v,y,x,w,T,b,C,A,S,k,O,M,D,I,E,R,N,V,P,F,q,B,W,j,z,L,U,X,Y,Z,G,$,H,Q,J,K,tt,te,tn,ti,ts,tr,ta,to,tl,th,tu,tc,td,tp,tf,tm,t_,tg,tv,ty,tx,tw,tT,tb,tC,tA,tS,tk,tO,tM,tD,tI,tE,tR,tN,tV,tP,tF,tq,tB,tW,tj,tz;let tL="15.0.2",tU=(e,i,s)=>({endTime:i,insertTime:s,type:"exponentialRampToValue",value:e}),tX=(e,i,s)=>({endTime:i,insertTime:s,type:"linearRampToValue",value:e}),tY=(e,i)=>({startTime:i,type:"setValue",value:e}),tZ=(e,i,s)=>({duration:s,startTime:i,type:"setValueCurve",values:e}),tG=(e,i,{startTime:s,target:r,timeConstant:a})=>r+(i-r)*Math.exp((s-e)/a),t$=e=>"exponentialRampToValue"===e.type,tH=e=>"linearRampToValue"===e.type,tQ=e=>t$(e)||tH(e),tJ=e=>"setValue"===e.type,tK=e=>"setValueCurve"===e.type,t0=(e,i,s,r)=>{let a=e[i];return void 0===a?r:tQ(a)||tJ(a)?a.value:tK(a)?a.values[a.values.length-1]:tG(s,t0(e,i-1,a.startTime,r),a)},t1=(e,i,s,r,a)=>void 0===s?[r.insertTime,a]:tQ(s)?[s.endTime,s.value]:tJ(s)?[s.startTime,s.value]:tK(s)?[s.startTime+s.duration,s.values[s.values.length-1]]:[s.startTime,t0(e,i-1,s.startTime,a)],t2=e=>"cancelAndHold"===e.type,t3=e=>"cancelScheduledValues"===e.type,t8=e=>t2(e)||t3(e)?e.cancelTime:t$(e)||tH(e)?e.endTime:e.startTime,t6=(e,i,s,{endTime:r,value:a})=>s===a?a:0<s&&0<a||s<0&&a<0?s*(a/s)**((e-i)/(r-i)):0,t4=(e,i,s,{endTime:r,value:a})=>s+(e-i)/(r-i)*(a-s),t5=(e,{duration:i,startTime:s,values:r})=>((e,i)=>{let s=Math.floor(i),r=Math.ceil(i);return s===r?e[s]:(1-(i-s))*e[s]+(1-(r-i))*e[r]})(r,(e-s)/i*(r.length-1)),t9=e=>"setTarget"===e.type;class t7{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){let i=t8(e);if(t2(e)||t3(e)){let s=this._automationEvents.findIndex(s=>t3(e)&&tK(s)?s.startTime+s.duration>=i:t8(s)>=i),r=this._automationEvents[s];if(-1!==s&&(this._automationEvents=this._automationEvents.slice(0,s)),t2(e)){let e=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&tQ(r)){if(void 0!==e&&t9(e))throw Error("The internal list is malformed.");let s=void 0===e?r.insertTime:tK(e)?e.startTime+e.duration:t8(e),a=void 0===e?this._defaultValue:tK(e)?e.values[e.values.length-1]:e.value,o=t$(r)?t6(i,s,a,r):t4(i,s,a,r),l=t$(r)?tU(o,i,this._currenTime):tX(o,i,this._currenTime);this._automationEvents.push(l)}if(void 0!==e&&t9(e)&&this._automationEvents.push(tY(this.getValue(i),i)),void 0!==e&&tK(e)&&e.startTime+e.duration>i){let s=i-e.startTime,r=(e.values.length-1)/e.duration,a=Math.max(2,1+Math.ceil(s*r)),o=s/(a-1)*r,l=e.values.slice(0,a);if(o<1)for(let i=1;i<a;i+=1){let s=o*i%1;l[i]=e.values[i-1]*(1-s)+e.values[i]*s}this._automationEvents[this._automationEvents.length-1]=tZ(l,e.startTime,s)}}}else{let s=this._automationEvents.findIndex(e=>t8(e)>i),r=-1===s?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(void 0!==r&&tK(r)&&t8(r)+r.duration>i)return!1;let a=t$(e)?tU(e.value,e.endTime,this._currenTime):tH(e)?tX(e.value,i,this._currenTime):e;if(-1===s)this._automationEvents.push(a);else{if(tK(e)&&i+e.duration>t8(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,a)}}return!0}flush(e){let i=this._automationEvents.findIndex(i=>t8(i)>e);if(i>1){let e=this._automationEvents.slice(i-1),s=e[0];t9(s)&&e.unshift(tY(t0(this._automationEvents,i-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=e}}getValue(e){if(0===this._automationEvents.length)return this._defaultValue;let i=this._automationEvents.findIndex(i=>t8(i)>e),s=this._automationEvents[i],r=(-1===i?this._automationEvents.length:i)-1,a=this._automationEvents[r];if(void 0!==a&&t9(a)&&(void 0===s||!tQ(s)||s.insertTime>e))return tG(e,t0(this._automationEvents,r-1,a.startTime,this._defaultValue),a);if(void 0!==a&&tJ(a)&&(void 0===s||!tQ(s)))return a.value;if(void 0!==a&&tK(a)&&(void 0===s||!tQ(s)||a.startTime+a.duration>e))return e<a.startTime+a.duration?t5(e,a):a.values[a.values.length-1];if(void 0!==a&&tQ(a)&&(void 0===s||!tQ(s)))return a.value;if(void 0!==s&&t$(s)){let[i,o]=t1(this._automationEvents,r,a,s,this._defaultValue);return t6(e,i,o,s)}if(void 0!==s&&tH(s)){let[i,o]=t1(this._automationEvents,r,a,s,this._defaultValue);return t4(e,i,o,s)}return this._defaultValue}}let et=new WeakSet,ee=new WeakMap,en=new WeakMap,ei=new WeakMap,es=new WeakMap,er=new WeakMap,ea=new WeakMap,eo=new WeakMap,el=new WeakMap,eh=new WeakMap,eu={construct:()=>eu},ec=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,ed=(e,i)=>{let s=[],r=e.replace(/^[\s]+/,""),a=r.match(ec);for(;null!==a;){let e=a[1].slice(1,-1),o=a[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,i).toString());s.push(o),a=(r=r.slice(a[0].length).replace(/^[\s]+/,"")).match(ec)}return[s.join(";"),r]},ep=e=>{if(void 0!==e&&!Array.isArray(e))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},ef=e=>{if(!(e=>{try{new new Proxy(e,eu)}catch{return!1}return!0})(e))throw TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},em=(e,i)=>{let s=e.get(i);if(void 0===s)throw Error("A value with the given key could not be found.");return s},e_=(e,i)=>{let s=Array.from(e).filter(i);if(s.length>1)throw Error("More than one element was found.");if(0===s.length)throw Error("No element was found.");let[r]=s;return e.delete(r),r},eg=(e,i,s,r)=>{let a=em(e,i),o=e_(a,e=>e[0]===s&&e[1]===r);return 0===a.size&&e.delete(i),o},ev=e=>em(ea,e),ey=e=>{if(et.has(e))throw Error("The AudioNode is already stored.");et.add(e),ev(e).forEach(e=>e(!0))},ex=e=>"port"in e,ew=e=>{if(!et.has(e))throw Error("The AudioNode is not stored.");et.delete(e),ev(e).forEach(e=>e(!1))},eT=(e,i)=>{!ex(e)&&i.every(e=>0===e.size)&&ew(e)},eb={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},eC=(e,i)=>e.context===i,eA=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},eS=()=>new DOMException("","IndexSizeError"),ek=e=>{var i;e.getChannelData=(i=e.getChannelData,s=>{try{return i.call(e,s)}catch(e){if(12===e.code)throw eS();throw e}})},eO={numberOfChannels:1},eM=e=>et.has(e),eD={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},eI=e=>em(ee,e),eE=e=>em(ei,e),eR=(e,i)=>{let{activeInputs:s}=eI(e);for(let r of(s.forEach(s=>s.forEach(([s])=>{i.includes(e)||eR(s,[...i,e])})),"playbackRate"in e?[e.playbackRate]:ex(e)?Array.from(e.parameters.values()):"frequency"in e&&"gain"in e?[e.Q,e.detune,e.frequency,e.gain]:"offset"in e?[e.offset]:!("frequency"in e)&&"gain"in e?[e.gain]:"detune"in e&&"frequency"in e?[e.detune,e.frequency]:"pan"in e?[e.pan]:[])){let e=eE(r);void 0!==e&&e.activeInputs.forEach(([e])=>eR(e,i))}eM(e)&&ew(e)},eN=e=>{eR(e.destination,[])},eV=e=>"context"in e,eP=e=>eV(e[0]),eF=(e,i,s,r)=>{for(let i of e)if(s(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(i),!0},eq=(e,i,[s,r],a)=>{eF(e,[i,s,r],e=>e[0]===i&&e[1]===s,a)},eB=(e,[i,s,r],a)=>{let o=e.get(i);void 0===o?e.set(i,new Set([[s,r]])):eF(o,[s,r],e=>e[0]===s,a)},eW=e=>"inputs"in e,ej=(e,i,s,r)=>{if(eW(i)){let a=i.inputs[r];return e.connect(a,s,0),[a,s,0]}return e.connect(i,s,r),[i,s,r]},ez=(e,i,s)=>{for(let r of e)if(r[0]===i&&r[1]===s)return e.delete(r),r;return null},eL=(e,i)=>{if(!ev(e).delete(i))throw Error("Missing the expected event listener.")},eU=(e,i,s)=>{let r=em(e,i),a=e_(r,e=>e[0]===s);return 0===r.size&&e.delete(i),a},eX=(e,i,s,r)=>{eW(i)?e.disconnect(i.inputs[r],s,0):e.disconnect(i,s,r)},eY=e=>em(en,e),eZ=e=>em(es,e),eG=e=>eo.has(e),e$=e=>!et.has(e),eH=(e,i)=>new Promise(s=>{if(null!==i)s(!0);else{let i=e.createScriptProcessor(256,1,1),r=e.createGain(),a=e.createBuffer(1,2,44100),o=a.getChannelData(0);o[0]=1,o[1]=1;let l=e.createBufferSource();l.buffer=a,l.loop=!0,l.connect(i).connect(e.destination),l.connect(r),l.disconnect(r),i.onaudioprocess=r=>{let a=r.inputBuffer.getChannelData(0);Array.prototype.some.call(a,e=>1===e)?s(!0):s(!1),l.stop(),i.onaudioprocess=null,l.disconnect(i),i.disconnect(e.destination)},l.start()}}),eQ=(e,i)=>{let s=new Map;for(let i of e)for(let e of i){let i=s.get(e);s.set(e,void 0===i?1:i+1)}s.forEach((e,s)=>i(s,e))},eJ=e=>"context"in e,eK=(e,i,s,r)=>{let{activeInputs:a,passiveInputs:o}=eE(i),{outputs:l}=eI(e),h=ev(e),u=l=>{let h=eY(e),u=eZ(i);if(l){let i=eU(o,e,s);eq(a,e,i,!1),r||eG(e)||h.connect(u,s)}else eB(o,e_(a,i=>i[0]===e&&i[1]===s),!1),r||eG(e)||h.disconnect(u,s)};return!!eF(l,[i,s],e=>e[0]===i&&e[1]===s,!0)&&(h.add(u),eM(e)?eq(a,e,[s,u],!0):eB(o,[e,s,u],!0),!0)},e0=(e,i,s,r,a)=>{let[o,l]=((e,i,s,r)=>{let{activeInputs:a,passiveInputs:o}=eI(i),l=ez(a[r],e,s);return null===l?[eg(o,e,s,r)[2],!1]:[l[2],!0]})(e,s,r,a);if(null!==o&&(eL(e,o),!l||i||eG(e)||eX(eY(e),eY(s),r,a)),eM(s)){let{activeInputs:e}=eI(s);eT(s,e)}},e1=(e,i,s,r)=>{let[a,o]=((e,i,s)=>{let{activeInputs:r,passiveInputs:a}=eE(i),o=ez(r,e,s);return null===o?[eU(a,e,s)[1],!1]:[o[2],!0]})(e,s,r);null!==a&&(eL(e,a),!o||i||eG(e)||eY(e).disconnect(eZ(s),r))};class e2{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,i=null){return this._map.forEach((s,r)=>e.call(i,s,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}let e3={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function e8(e,i,s,r,a){if("function"==typeof e.copyFromChannel)0===i[s].byteLength&&(i[s]=new Float32Array(128)),e.copyFromChannel(i[s],r,a);else{let o=e.getChannelData(r);if(0===i[s].byteLength)i[s]=o.slice(a,a+128);else{let e=new Float32Array(o.buffer,a*Float32Array.BYTES_PER_ELEMENT,128);i[s].set(e)}}}let e6=(e,i,s,r,a)=>{"function"==typeof e.copyToChannel?0!==i[s].byteLength&&e.copyToChannel(i[s],r,a):0!==i[s].byteLength&&e.getChannelData(r).set(i[s],a)},e4=(e,i)=>{let s=[];for(let r=0;r<e;r+=1){let e=[],a="number"==typeof i?i:i[r];for(let i=0;i<a;i+=1)e.push(new Float32Array(128));s.push(e)}return s},e5=async(e,i,s,r,a,o,l)=>{let h=null===i?128*Math.ceil(e.context.length/128):i.length,u=r.channelCount*r.numberOfInputs,c=a.reduce((e,i)=>e+i,0),d=0===c?null:s.createBuffer(c,h,s.sampleRate);if(void 0===o)throw Error("Missing the processor constructor.");let p=eI(e),f=await ((e,i)=>{let s=em(eh,e);return em(s,eY(i))})(s,e),m=e4(r.numberOfInputs,r.channelCount),_=e4(r.numberOfOutputs,a),g=Array.from(e.parameters.keys()).reduce((e,i)=>({...e,[i]:new Float32Array(128)}),{});for(let c=0;c<h;c+=128){if(r.numberOfInputs>0&&null!==i)for(let e=0;e<r.numberOfInputs;e+=1)for(let s=0;s<r.channelCount;s+=1)e8(i,m[e],s,s,c);void 0!==o.parameterDescriptors&&null!==i&&o.parameterDescriptors.forEach(({name:e},s)=>{e8(i,g,e,u+s,c)});for(let e=0;e<r.numberOfInputs;e+=1)for(let i=0;i<a[e];i+=1)0===_[e][i].byteLength&&(_[e][i]=new Float32Array(128));try{let e=m.map((e,i)=>0===p.activeInputs[i].size?[]:e),i=l(c/s.sampleRate,s.sampleRate,()=>f.process(e,_,g));if(null!==d)for(let e=0,i=0;e<r.numberOfOutputs;e+=1){for(let s=0;s<a[e];s+=1)e6(d,_[e],s,i+s,c);i+=a[e]}if(!i)break}catch(i){e.dispatchEvent(new ErrorEvent("processorerror",{colno:i.colno,filename:i.filename,lineno:i.lineno,message:i.message}));break}}return d},e9={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},e7={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},nt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ne={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},nn={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},ni=e=>{let{port1:i,port2:s}=new MessageChannel;return new Promise(r=>{let a=()=>{s.onmessage=null,i.close(),s.close(),r()};s.onmessage=()=>a();try{i.postMessage(e,[e])}catch{}finally{a()}})},ns={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},nr=(e,i,s)=>{let r=i[s];if(void 0===r)throw e();return r},na={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},no={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},nl=()=>new DOMException("","InvalidStateError"),nh=()=>new DOMException("","InvalidAccessError"),nu={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},nc=(e,i,s,r,a,o,l,h,u,c,d)=>{let p=c.length,f=h;for(let h=0;h<p;h+=1){let p=s[0]*c[h];for(let i=1;i<a;i+=1){let r=f-i&u-1;p+=s[i]*o[r],p-=e[i]*l[r]}for(let e=a;e<r;e+=1)p+=s[e]*o[f-e&u-1];for(let s=a;s<i;s+=1)p-=e[s]*l[f-s&u-1];o[f]=c[h],l[f]=p,f=f+1&u-1,d[h]=p}return f},nd={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},np=e=>{let i=new Uint32Array([0x46464952,40,0x45564157,0x20746d66,16,131073,44100,176400,1048580,0x61746164,4,0]);try{let s=e.decodeAudioData(i.buffer,()=>{});return void 0!==s&&(s.catch(()=>{}),!0)}catch{}return!1},nf=(e,i,s)=>{let r=i[s];void 0!==r&&r!==e[s]&&(e[s]=r)},nm=(e,i)=>{nf(e,i,"channelCount"),nf(e,i,"channelCountMode"),nf(e,i,"channelInterpretation")},n_=e=>"function"==typeof e.getFloatTimeDomainData,ng=(e,i,s)=>{let r=i[s];void 0!==r&&r!==e[s].value&&(e[s].value=r)},nv=e=>{let i;e.start=(i=e.start,(s=0,r=0,a)=>{if("number"==typeof a&&a<0||r<0||s<0)throw RangeError("The parameters can't be negative.");i.call(e,s,r,a)})},ny=e=>{var i;e.stop=(i=e.stop,(s=0)=>{if(s<0)throw RangeError("The parameter can't be negative.");i.call(e,s)})},nx=(e,i)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*i))))),nw=async(e,i)=>new e(await new Promise((e,s)=>{let{port1:r,port2:a}=new MessageChannel;r.onmessage=({data:i})=>{r.close(),a.close(),e(i)},r.onmessageerror=({data:e})=>{r.close(),a.close(),s(e)},a.postMessage(i)})),nT=(e,i)=>{let s=e.createBiquadFilter();return nm(s,i),ng(s,i,"Q"),ng(s,i,"detune"),ng(s,i,"frequency"),ng(s,i,"gain"),nf(s,i,"type"),s},nb=(e,i)=>{let s=e.createChannelSplitter(i.numberOfOutputs);return nm(s,i),(e=>{let i=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>i,set:e=>{if(e!==i)throw nl()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw nl()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw nl()}})})(s),s},nC=(e,i)=>(e.connect=i.connect.bind(i),e.disconnect=i.disconnect.bind(i),e),nA=(e,i)=>{let s=e.createDelay(i.maxDelayTime);return nm(s,i),ng(s,i,"delayTime"),s},nS=(e,i)=>{let s=e.createGain();return nm(s,i),ng(s,i,"gain"),s};function nk(e,i){var s;let r=[0,0];for(let a=e.length-1;a>=0;a-=1)r=[(s=r)[0]*i[0]-s[1]*i[1],s[0]*i[1]+s[1]*i[0]],r[0]+=e[a];return r}let nO=(e,i,s,r)=>e.createScriptProcessor(i,s,r),nM=()=>new DOMException("","NotSupportedError"),nD={numberOfChannels:1},nI={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},nE={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},nR={disableNormalization:!1},nN={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},nV={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},nP=(e,i,s)=>void 0===e.copyFromChannel?e.getChannelData(s)[0]:(e.copyFromChannel(i,s),i[0]),nF=e=>{if(null===e)return!1;let i=e.length;return i%2!=0?0!==e[Math.floor(i/2)]:e[i/2-1]+e[i/2]!==0},nq=(e,i,s,r)=>{let a=e;for(;!a.hasOwnProperty(i);)a=Object.getPrototypeOf(a);let{get:o,set:l}=Object.getOwnPropertyDescriptor(a,i);Object.defineProperty(e,i,{get:s(o),set:r(l)})},nB=(e,i,s)=>{try{e.setValueAtTime(i,s)}catch(r){if(9!==r.code)throw r;nB(e,i,s+1e-7)}},nW=e=>{let i=e.createOscillator();try{i.start(-1)}catch(e){return e instanceof RangeError}return!1},nj=e=>{let i=e.createBuffer(1,1,44100),s=e.createBufferSource();s.buffer=i,s.start(),s.stop();try{return s.stop(),!0}catch{return!1}},nz=e=>{let i=e.createOscillator();try{i.stop(-1)}catch(e){return e instanceof RangeError}return!1},nL=(e,i)=>{var s;let r,a;let o=i.createGain();e.connect(o);let l=(r=e.disconnect,()=>{r.call(e,o),e.removeEventListener("ended",l)});e.addEventListener("ended",l),nC(e,o),e.stop=(s=e.stop,a=!1,(i=0)=>{if(a)try{s.call(e,i)}catch{o.gain.setValueAtTime(0,i)}else s.call(e,i),a=!0})},nU=(e,i)=>s=>{let r={value:e};return Object.defineProperties(s,{currentTarget:r,target:r}),"function"==typeof i?i.call(e,s):i.handleEvent.call(e,s)},nX=new WeakMap,nY=(rP=new Map,rF=new WeakMap,(e,i)=>{let s=rF.get(e);if(void 0!==s)return s;let r=rP.get(e);if(void 0!==r)return r;try{let s=i();return s instanceof Promise?(rP.set(e,s),s.catch(()=>!1).then(i=>(rP.delete(e),rF.set(e,i),i))):(rF.set(e,s),s)}catch{return rF.set(e,!1),!1}}),nZ="undefined"==typeof window?null:window,nG=(e,i)=>{let s=e.createAnalyser();if(nm(s,i),!(i.maxDecibels>i.minDecibels))throw eS();return nf(s,i,"fftSize"),nf(s,i,"maxDecibels"),nf(s,i,"minDecibels"),nf(s,i,"smoothingTimeConstant"),nY(n_,()=>n_(s))||(s.getFloatTimeDomainData=e=>{let i=new Uint8Array(e.length);s.getByteTimeDomainData(i);let r=Math.max(i.length,s.fftSize);for(let s=0;s<r;s+=1)e[s]=.0078125*(i[s]-128);return e}),s},n$=e=>{let i=eI(e);if(null===i.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return i.renderer},nH=async(e,i,s)=>{let r=eI(e);await Promise.all(r.activeInputs.map((r,a)=>Array.from(r).map(async([r,o])=>{let l=n$(r),h=await l.render(r,i),u=e.context.destination;eG(r)||e===u&&eG(e)||h.connect(s,o,a)})).reduce((e,i)=>[...e,...i],[]))},nQ=e=>{let i=er.get(e);if(void 0===i)throw nl();return i},nJ=null===nZ?null:nZ.hasOwnProperty("OfflineAudioContext")?nZ.OfflineAudioContext:nZ.hasOwnProperty("webkitOfflineAudioContext")?nZ.webkitOfflineAudioContext:null,nK=e=>null!==nJ&&e instanceof nJ,n0=new WeakMap,n1=class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,i,s){if(null!==i){let r=this._listeners.get(i);void 0===r&&(r=nU(this,i),"function"==typeof i&&this._listeners.set(i,r)),this._nativeEventTarget.addEventListener(e,r,s)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,i,s){let r=null===i?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,s)}},n2=null===nZ?null:nZ.hasOwnProperty("AudioContext")?nZ.AudioContext:nZ.hasOwnProperty("webkitAudioContext")?nZ.webkitAudioContext:null,n3=e=>null!==n2&&e instanceof n2,n8=e=>null!==nZ&&"function"==typeof nZ.AudioNode&&e instanceof nZ.AudioNode,n6=e=>null!==nZ&&"function"==typeof nZ.AudioParam&&e instanceof nZ.AudioParam,n4=null===nZ?null:nZ.hasOwnProperty("AudioWorkletNode")?nZ.AudioWorkletNode:null,n5=(e=(e,i,s)=>{let r=[];for(let e=0;e<s.numberOfInputs;e+=1)r.push(new Set);ee.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:i})},i=((e,i,s,r,a,o,l,h,u,c,d,p,f)=>{let m=new WeakMap;return(_,g,v,y,x)=>{let{activeInputs:w,passiveInputs:T}=o(g),{outputs:b}=o(_),C=h(_),A=o=>{let h=u(g),c=u(_);if(o){let i=eg(T,_,v,y);e(w,_,i,!1),x||p(_)||s(c,h,v,y),f(g)&&ey(g)}else{let e=r(w,_,v,y);i(T,y,e,!1),x||p(_)||a(c,h,v,y);let s=l(g);if(0===s)d(g)&&eT(g,w);else{let e=m.get(g);void 0!==e&&clearTimeout(e),m.set(g,setTimeout(()=>{d(g)&&eT(g,w)},1e3*s))}}};return!!c(b,[g,v,y],e=>e[0]===g&&e[1]===v&&e[2]===y,!0)&&(C.add(A),d(_)?e(w,_,[v,y,A],!0):i(T,y,[_,v,A],!0),!0)}})((e,i,[s,r,a],o)=>{eF(e[r],[i,s,a],e=>e[0]===i&&e[1]===s,o)},(e,i,[s,r,a],o)=>{let l=e.get(s);void 0===l?e.set(s,new Set([[r,i,a]])):eF(l,[r,i,a],e=>e[0]===r&&e[1]===i,o)},ej,(e,i,s,r)=>e_(e[r],e=>e[0]===i&&e[1]===s),eX,eI,e=>{var i;return null!==(i=nX.get(e))&&void 0!==i?i:0},ev,eY,eF,eM,eG,e$),s=e=>(i,s)=>{let r=eo.get(i);if(void 0===r){if(!e&&eM(i)){let e=eY(i),{outputs:s}=eI(i);for(let i of s)if(eP(i))eX(e,eY(i[0]),i[1],i[2]);else{let s=eZ(i[0]);e.disconnect(s,i[1])}}eo.set(i,s)}else eo.set(i,r+s)},r=(e,i)=>{let s=eo.get(e);if(void 0===s)throw Error("Missing the expected cycle count.");let r=nK(nQ(e.context));if(s===i){if(eo.delete(e),!r&&eM(e)){let i=eY(e),{outputs:s}=eI(e);for(let e of s)if(eP(e))ej(i,eY(e[0]),e[1],e[2]);else{let s=eZ(e[0]);i.connect(s,e[1])}}}else eo.set(e,s-i)},a=function e(i,s){let r=eV(s)?s:em(n0,s);if("delayTime"in r)return[];if(i[0]===r)return[i];if(i.includes(r))return[];let{outputs:a}=eI(r);return Array.from(a).map(s=>e([...i,r],s[0])).reduce((e,i)=>e.concat(i),[])},o=n1,class extends o{constructor(i,s,r,a){super(r),this._context=i,this._nativeAudioNode=r;let o=nQ(i);n3(o)&&!0!==nY(eH,()=>eH(o,n4))&&(e=>{let i,s;let r=new Map;e.connect=(i=e.connect.bind(e),(e,s=0,a=0)=>{let o=eJ(e)?i(e,s,a):i(e,s),l=r.get(e);return void 0===l?r.set(e,[{input:a,output:s}]):l.every(e=>e.input!==a||e.output!==s)&&l.push({input:a,output:s}),o}),e.disconnect=(s=e.disconnect,(i,a,o)=>{if(s.apply(e),void 0===i)r.clear();else if("number"==typeof i)for(let[e,s]of r){let a=s.filter(e=>e.output!==i);0===a.length?r.delete(e):r.set(e,a)}else if(r.has(i)){if(void 0===a)r.delete(i);else{let e=r.get(i);if(void 0!==e){let s=e.filter(e=>e.output!==a&&(e.input!==o||void 0===o));0===s.length?r.delete(i):r.set(i,s)}}}for(let[i,s]of r)s.forEach(s=>{eJ(i)?e.connect(i,s.output,s.input):e.connect(i,s.output)})})})(r),en.set(this,r),ea.set(this,new Set),"closed"!==i.state&&s&&ey(this),e(this,a,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,r=0,o=0){if(r<0||r>=this._nativeAudioNode.numberOfOutputs)throw eS();let l=nK(nQ(this._context));if(n8(e)||n6(e))throw nh();if(eV(e)){let h=eY(e);try{let i=ej(this._nativeAudioNode,h,r,o),s=e$(this);(l||s)&&this._nativeAudioNode.disconnect(...i),"closed"!==this.context.state&&!s&&e$(e)&&ey(e)}catch(e){if(12===e.code)throw nh();throw e}return i(this,e,r,o,l)&&eQ(a([this],e),s(l)),e}let h=eZ(e);if("playbackRate"===h.name&&1024===h.maxValue)throw nM();try{this._nativeAudioNode.connect(h,r),(l||e$(this))&&this._nativeAudioNode.disconnect(h,r)}catch(e){if(12===e.code)throw nh();throw e}eK(this,e,r,l)&&eQ(a([this],e),s(l))}disconnect(e,i,s){let o;let l=nK(nQ(this._context));if(void 0===e)o=((e,i)=>{let s=eI(e),r=[];for(let a of s.outputs)eP(a)?e0(e,i,...a):e1(e,i,...a),r.push(a[0]);return s.outputs.clear(),r})(this,l);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw eS();o=((e,i,s)=>{let r=eI(e),a=[];for(let o of r.outputs)o[1]===s&&(eP(o)?e0(e,i,...o):e1(e,i,...o),a.push(o[0]),r.outputs.delete(o));return a})(this,l,e)}else{if(void 0!==i&&(i<0||i>=this.numberOfOutputs)||eV(e)&&void 0!==s&&(s<0||s>=e.numberOfInputs))throw eS();if(0===(o=((e,i,s,r,a)=>{let o=eI(e);return Array.from(o.outputs).filter(e=>e[0]===s&&(void 0===r||e[1]===r)&&(void 0===a||e[2]===a)).map(s=>(eP(s)?e0(e,i,...s):e1(e,i,...s),o.outputs.delete(s),s[0]))})(this,l,e,i,s)).length)throw nh()}for(let e of o)eQ(a([this],e),r)}}),n9=(l=n5,h=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i);return eC(r,s)||(r=nG(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,fftSize:r.fftSize,maxDecibels:r.maxDecibels,minDecibels:r.minDecibels,smoothingTimeConstant:r.smoothingTimeConstant})),e.set(s,r),await nH(i,s,r),r})(i,s)}}},class extends l{constructor(e,i){let s=nQ(e),r=nG(s,{...eb,...i});super(e,!1,r,nK(s)?h():null),this._nativeAnalyserNode=r}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){let i=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=i,eS()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){let i=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=i,eS()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}),n7=new WeakSet,it=null===nZ?null:nZ.hasOwnProperty("AudioBuffer")?nZ.AudioBuffer:null,ie=(rq=new Uint32Array(1),e=>(rq[0]=e,rq[0])),ii=e=>{e.copyFromChannel=(i,s,r=0)=>{let a=ie(r),o=ie(s);if(o>=e.numberOfChannels)throw eS();let l=e.length,h=e.getChannelData(o),u=i.length;for(let e=a<0?-a:0;e+a<l&&e<u;e+=1)i[e]=h[e+a]},e.copyToChannel=(i,s,r=0)=>{let a=ie(r),o=ie(s);if(o>=e.numberOfChannels)throw eS();let l=e.length,h=e.getChannelData(o),u=i.length;for(let e=a<0?-a:0;e+a<l&&e<u;e+=1)h[e+a]=i[e]}},is=e=>{let i,s;e.copyFromChannel=(i=e.copyFromChannel,(s,r,a=0)=>{let o=ie(a),l=ie(r);if(o<e.length)return i.call(e,s,l,o)}),e.copyToChannel=(s=e.copyToChannel,(i,r,a=0)=>{let o=ie(a),l=ie(r);if(o<e.length)return s.call(e,i,l,o)})},ir=(rM=()=>{if(null===it)return!1;try{new it({length:1,sampleRate:44100})}catch{return!1}return!0},u=null,class e{constructor(e){if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");let{length:i,numberOfChannels:s,sampleRate:r}={...eO,...e};null===u&&(u=new nJ(1,1,44100));let a=null!==it&&nY(rM,rM)?new it({length:i,numberOfChannels:s,sampleRate:r}):u.createBuffer(s,i,r);if(0===a.numberOfChannels)throw nM();return"function"!=typeof a.copyFromChannel?(ii(a),ek(a)):nY(eA,()=>eA(a))||is(a),n7.add(a),a}static[Symbol.hasInstance](i){return null!==i&&"object"==typeof i&&Object.getPrototypeOf(i)===e.prototype||n7.has(i)}}),ia=(e,i)=>{let s=nS(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.connect(s).connect(e.destination);let r=()=>{i.removeEventListener("ended",r),i.disconnect(s),s.disconnect()};i.addEventListener("ended",r)},io=async(e,i,s)=>{let r=eE(e);await Promise.all(Array.from(r.activeInputs).map(async([e,r])=>{let a=n$(e),o=await a.render(e,i);eG(e)||o.connect(s,r)}))},il=(e,i,s)=>io(i,e,s),ih=(c=e=>{let i=e.createBufferSource();i.start();try{i.start()}catch{return!0}return!1},d=e=>{let i=e.createBufferSource(),s=e.createBuffer(1,1,44100);i.buffer=s;try{i.start(0,1)}catch{return!1}return!0},p=e=>{let i=e.createBufferSource();i.start();try{i.stop()}catch{return!1}return!0},f=e=>{let i;e.start=(i=e.start,(s=0,r=0,a)=>{let o=e.buffer,l=null===o?r:Math.min(o.duration,r);null!==o&&l>o.duration-.5/e.context.sampleRate?i.call(e,s,0,0):i.call(e,s,l,a)})},m=(e,i)=>{let s=i.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=s),nq(e,"buffer",i=>()=>{let r=i.call(e);return r===s?null:r},i=>r=>i.call(e,null===r?s:r))},(e,i)=>{var s;let r;let a=e.createBufferSource();return nm(a,i),ng(a,i,"playbackRate"),nf(a,i,"buffer"),nf(a,i,"loop"),nf(a,i,"loopEnd"),nf(a,i,"loopStart"),nY(c,()=>c(e))||(a.start=(s=a.start,r=!1,(e=0,i=0,o)=>{if(r)throw nl();s.call(a,e,i,o),r=!0})),nY(d,()=>d(e))||f(a),nY(p,()=>p(e))||m(a,e),nY(nW,()=>nW(e))||nv(a),nY(nj,()=>nj(e))||nL(a,e),nY(nz,()=>nz(e))||ny(a),ia(e,a),a}),iu=(_=e=>{let i=eE(e);if(null===i.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return i.renderer},(e,i,s)=>(_(i).replay(s),io(i,e,s))),ic=(g=(e,i)=>{ei.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:i})},v=e=>({replay(i){for(let s of e)if("exponentialRampToValue"===s.type){let{endTime:e,value:r}=s;i.exponentialRampToValueAtTime(r,e)}else if("linearRampToValue"===s.type){let{endTime:e,value:r}=s;i.linearRampToValueAtTime(r,e)}else if("setTarget"===s.type){let{startTime:e,target:r,timeConstant:a}=s;i.setTargetAtTime(r,e,a)}else if("setValue"===s.type){let{startTime:e,value:r}=s;i.setValueAtTime(r,e)}else{if("setValueCurve"!==s.type)throw Error("Can't apply an unknown automation.");{let{duration:e,startTime:r,values:a}=s;i.setValueCurveAtTime(a,r,e)}}}}),y=e=>({cancelTime:e,type:"cancelAndHold"}),x=e=>({cancelTime:e,type:"cancelScheduledValues"}),w=(e,i)=>({endTime:i,type:"exponentialRampToValue",value:e}),T=(e,i)=>({endTime:i,type:"linearRampToValue",value:e}),b=(e,i,s)=>({startTime:i,target:e,timeConstant:s,type:"setTarget"}),(e,i,s,r=null,a=null)=>{let o=s.value,l=new t7(o),h=i?v(l):null,u={get defaultValue(){return o},get maxValue(){return null===r?s.maxValue:r},get minValue(){return null===a?s.minValue:a},get value(){return s.value},set value(t){s.value=t,u.setValueAtTime(t,e.context.currentTime)},cancelAndHoldAtTime(i){if("function"==typeof s.cancelAndHoldAtTime)null===h&&l.flush(e.context.currentTime),l.add(y(i)),s.cancelAndHoldAtTime(i);else{let r=Array.from(l).pop();null===h&&l.flush(e.context.currentTime),l.add(y(i));let a=Array.from(l).pop();s.cancelScheduledValues(i),r!==a&&void 0!==a&&("exponentialRampToValue"===a.type?s.exponentialRampToValueAtTime(a.value,a.endTime):"linearRampToValue"===a.type?s.linearRampToValueAtTime(a.value,a.endTime):"setValue"===a.type?s.setValueAtTime(a.value,a.startTime):"setValueCurve"===a.type&&s.setValueCurveAtTime(a.values,a.startTime,a.duration))}return u},cancelScheduledValues:i=>(null===h&&l.flush(e.context.currentTime),l.add(x(i)),s.cancelScheduledValues(i),u),exponentialRampToValueAtTime(i,r){if(0===i||!Number.isFinite(r)||r<0)throw RangeError();let a=e.context.currentTime;return null===h&&l.flush(a),0===Array.from(l).length&&(l.add(tY(o,a)),s.setValueAtTime(o,a)),l.add(w(i,r)),s.exponentialRampToValueAtTime(i,r),u},linearRampToValueAtTime(i,r){let a=e.context.currentTime;return null===h&&l.flush(a),0===Array.from(l).length&&(l.add(tY(o,a)),s.setValueAtTime(o,a)),l.add(T(i,r)),s.linearRampToValueAtTime(i,r),u},setTargetAtTime:(i,r,a)=>(null===h&&l.flush(e.context.currentTime),l.add(b(i,r,a)),s.setTargetAtTime(i,r,a),u),setValueAtTime:(i,r)=>(null===h&&l.flush(e.context.currentTime),l.add(tY(i,r)),s.setValueAtTime(i,r),u),setValueCurveAtTime(i,r,a){let o=i instanceof Float32Array?i:new Float32Array(i);if(null!==n2&&"webkitAudioContext"===n2.name){let i=r+a,c=e.context.sampleRate,d=Math.ceil(r*c),p=Math.floor(i*c),f=p-d,m=new Float32Array(f);for(let e=0;e<f;e+=1){let i=(o.length-1)/a*((d+e)/c-r),s=Math.floor(i),l=Math.ceil(i);m[e]=s===l?o[s]:(1-(i-s))*o[s]+(1-(l-i))*o[l]}null===h&&l.flush(e.context.currentTime),l.add(tZ(m,r,a)),s.setValueCurveAtTime(m,r,a);let _=p/c;_<i&&nB(u,m[m.length-1],_),nB(u,o[o.length-1],i)}else null===h&&l.flush(e.context.currentTime),l.add(tZ(o,r,a)),s.setValueCurveAtTime(o,r,a);return u}};return es.set(u,s),n0.set(u,e),g(u,h),u}),id=(C=n5,A=()=>{let e=new WeakMap,i=null,s=null;return{set start(t){i=t},set stop(t){s=t},render(r,a){let o=e.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=eY(r),l=eC(o,a);return l||(o=ih(a,{buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,loop:o.loop,loopEnd:o.loopEnd,loopStart:o.loopStart,playbackRate:o.playbackRate.value}),null!==i&&o.start(...i),null!==s&&o.stop(s)),e.set(a,o),l?await il(a,r.playbackRate,o.playbackRate):await iu(a,r.playbackRate,o.playbackRate),await nH(r,a,o),o})(r,a)}}},class extends C{constructor(e,i){let s=nQ(e),r={...eD,...i},a=ih(s,r),o=nK(s),l=o?A():null;super(e,!1,a,l),this._audioBufferSourceNodeRenderer=l,this._isBufferNullified=!1,this._isBufferSet=null!==r.buffer,this._nativeAudioBufferSourceNode=a,this._onended=null,this._playbackRate=ic(this,o,a.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw nl();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){let i="function"==typeof e?nU(this,e):null;this._nativeAudioBufferSourceNode.onended=i;let s=this._nativeAudioBufferSourceNode.onended;this._onended=null!==s&&s===i?e:s}get playbackRate(){return this._playbackRate}start(e=0,i=0,s){if(this._nativeAudioBufferSourceNode.start(e,i,s),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===s?[e,i]:[e,i,s]),"closed"!==this.context.state){ey(this);let e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),eM(this)&&ew(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}),ip=(S=n5,k=e=>{let i=new WeakMap;return{render(s,r){let a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r)=>{let a=r.destination;return i.set(r,a),await e(s,r,a),a})(s,r)}}},O=(e,i,s)=>{let r=e.destination;if(r.channelCount!==i)try{r.channelCount=i}catch{}s&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:i});let a=nS(e,{channelCount:i,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return nq(a,"channelCount",e=>()=>e.call(a),e=>i=>{e.call(a,i);try{r.channelCount=i}catch(e){if(i>r.maxChannelCount)throw e}}),nq(a,"channelCountMode",e=>()=>e.call(a),e=>i=>{e.call(a,i),r.channelCountMode=i}),nq(a,"channelInterpretation",e=>()=>e.call(a),e=>i=>{e.call(a,i),r.channelInterpretation=i}),Object.defineProperty(a,"maxChannelCount",{get:()=>r.maxChannelCount}),a.connect(r),a},class extends S{constructor(e,i){let s=nQ(e),r=nK(s),a=O(s,i,r);super(e,!1,a,r?k(nH):null),this._isNodeOfNativeOfflineAudioContext=r,this._nativeAudioDestinationNode=a}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw nl();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw eS();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw nl();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}),im=(e,i)=>nX.set(e,i),i_=(M=n5,D=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i),a=eC(r,s);return a||(r=nT(s,{Q:r.Q.value,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,detune:r.detune.value,frequency:r.frequency.value,gain:r.gain.value,type:r.type})),e.set(s,r),a?(await il(s,i.Q,r.Q),await il(s,i.detune,r.detune),await il(s,i.frequency,r.frequency),await il(s,i.gain,r.gain)):(await iu(s,i.Q,r.Q),await iu(s,i.detune,r.detune),await iu(s,i.frequency,r.frequency),await iu(s,i.gain,r.gain)),await nH(i,s,r),r})(i,s)}}},class extends M{constructor(e,i){let s=nQ(e),r=nT(s,{...e9,...i}),a=nK(s);super(e,!1,r,a?D():null),this._Q=ic(this,a,r.Q,34028234663852886e22,-34028234663852886e22),this._detune=ic(this,a,r.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=ic(this,a,r.frequency,e.sampleRate/2,0),this._gain=ic(this,a,r.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=r,im(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,i,s){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,i,s)}catch(e){if(11===e.code)throw nh();throw e}if(e.length!==i.length||i.length!==s.length)throw nh()}}),ig=(e,i,s)=>{let r,a;let o=new Set;return e.connect=(r=e.connect,(s,a=0,l=0)=>{let h=0===o.size;if(n8(s))return r.call(e,s,a,l),eF(o,[s,a,l],e=>e[0]===s&&e[1]===a&&e[2]===l,!0),h&&i(),s;r.call(e,s,a),eF(o,[s,a],e=>e[0]===s&&e[1]===a,!0),h&&i()}),e.disconnect=(a=e.disconnect,(i,r,l)=>{let h=o.size>0;if(void 0===i)a.apply(e),o.clear();else if("number"==typeof i)for(let s of(a.call(e,i),o))s[1]===i&&o.delete(s);else for(let s of(n8(i)?a.call(e,i,r,l):a.call(e,i,r),o))s[0]!==i||void 0!==r&&s[1]!==r||void 0!==l&&s[2]!==l||o.delete(s);let u=0===o.size;h&&u&&s()}),e},iv=(I=(e,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw nl()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw nl()}});let s=e.createBufferSource();ig(i,()=>{let e=i.numberOfInputs;for(let r=0;r<e;r+=1)s.connect(i,0,r)},()=>s.disconnect(i))},(e,i)=>{let s=e.createChannelMerger(i.numberOfInputs);return null!==n2&&"webkitAudioContext"===n2.name&&I(e,s),nm(s,i),s}),iy=(E=n5,R=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i);return eC(r,s)||(r=iv(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfInputs:r.numberOfInputs})),e.set(s,r),await nH(i,s,r),r})(i,s)}}},class extends E{constructor(e,i){let s=nQ(e);super(e,!1,iv(s,{...e7,...i}),nK(s)?R():null)}}),ix=(N=n5,V=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i);return eC(r,s)||(r=nb(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,numberOfOutputs:r.numberOfOutputs})),e.set(s,r),await nH(i,s,r),r})(i,s)}}},P=e=>({...e,channelCount:e.numberOfOutputs}),class extends N{constructor(e,i){let s=nQ(e);super(e,!1,nb(s,P({...nt,...i})),nK(s)?V():null)}}),iw=(F=(e,{offset:i,...s})=>{let r=e.createBuffer(1,2,44100),a=ih(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=nS(e,{...s,gain:i}),l=r.getChannelData(0);return l[0]=1,l[1]=1,a.buffer=r,a.loop=!0,ia(e,a),ig(nC({get bufferSize(){},get channelCount(){return o.channelCount},set channelCount(t){o.channelCount=t},get channelCountMode(){return o.channelCountMode},set channelCountMode(t){o.channelCountMode=t},get channelInterpretation(){return o.channelInterpretation},set channelInterpretation(t){o.channelInterpretation=t},get context(){return o.context},get inputs(){return[]},get numberOfInputs(){return a.numberOfInputs},get numberOfOutputs(){return o.numberOfOutputs},get offset(){return o.gain},get onended(){return a.onended},set onended(t){a.onended=t},addEventListener:(...e)=>a.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>a.dispatchEvent(e[0]),removeEventListener:(...e)=>a.removeEventListener(e[0],e[1],e[2]),start(e=0){a.start.call(a,e)},stop(e=0){a.stop.call(a,e)}},o),()=>a.connect(o),()=>a.disconnect(o))},(e,i)=>{if(void 0===e.createConstantSource)return F(e,i);let s=e.createConstantSource();return nm(s,i),ng(s,i,"offset"),nY(nW,()=>nW(e))||nv(s),nY(nz,()=>nz(e))||ny(s),ia(e,s),s}),iT=(q=n5,B=()=>{let e=new WeakMap,i=null,s=null;return{set start(t){i=t},set stop(t){s=t},render(r,a){let o=e.get(a);return void 0!==o?Promise.resolve(o):(async(r,a)=>{let o=eY(r),l=eC(o,a);return l||(o=iw(a,{channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,offset:o.offset.value}),null!==i&&o.start(i),null!==s&&o.stop(s)),e.set(a,o),l?await il(a,r.offset,o.offset):await iu(a,r.offset,o.offset),await nH(r,a,o),o})(r,a)}}},class extends q{constructor(e,i){let s=nQ(e),r=iw(s,{...ne,...i}),a=nK(s),o=a?B():null;super(e,!1,r,o),this._constantSourceNodeRenderer=o,this._nativeConstantSourceNode=r,this._offset=ic(this,a,r.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){let i="function"==typeof e?nU(this,e):null;this._nativeConstantSourceNode.onended=i;let s=this._nativeConstantSourceNode.onended;this._onended=null!==s&&s===i?e:s}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){ey(this);let e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),eM(this)&&ew(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}),ib=(e,i)=>{let s=e.createConvolver();if(nm(s,i),i.disableNormalization===s.normalize&&(s.normalize=!i.disableNormalization),nf(s,i,"buffer"),i.channelCount>2||(nq(s,"channelCount",e=>()=>e.call(s),e=>i=>{if(i>2)throw nM();return e.call(s,i)}),"max"===i.channelCountMode))throw nM();return nq(s,"channelCountMode",e=>()=>e.call(s),e=>i=>{if("max"===i)throw nM();return e.call(s,i)}),s},iC=(W=n5,j=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i);return eC(r,s)||(r=ib(s,{buffer:r.buffer,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,disableNormalization:!r.normalize})),e.set(s,r),eW(r)?await nH(i,s,r.inputs[0]):await nH(i,s,r),r})(i,s)}}},class extends W{constructor(e,i){let s=nQ(e),r={...nn,...i},a=ib(s,r);super(e,!1,a,nK(s)?j():null),this._isBufferNullified=!1,this._nativeConvolverNode=a,null!==r.buffer&&im(this,r.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){let e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0,im(this,0)}else this._isBufferNullified=!1,im(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}}),iA=(z=n5,L=e=>{let i=new WeakMap;return{render(s,r){let a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r)=>{let a=eY(s),o=eC(a,r);return o||(a=nA(r,{channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,delayTime:a.delayTime.value,maxDelayTime:e})),i.set(r,a),o?await il(r,s.delayTime,a.delayTime):await iu(r,s.delayTime,a.delayTime),await nH(s,r,a),a})(s,r)}}},class extends z{constructor(e,i){let s=nQ(e),r={...ns,...i},a=nA(s,r),o=nK(s);super(e,!1,a,o?L(r.maxDelayTime):null),this._delayTime=ic(this,o,a.delayTime),im(this,r.maxDelayTime)}get delayTime(){return this._delayTime}}),iS=(e,i)=>{let s=e.createDynamicsCompressor();if(nm(s,i),i.channelCount>2||"max"===i.channelCountMode)throw nM();return ng(s,i,"attack"),ng(s,i,"knee"),ng(s,i,"ratio"),ng(s,i,"release"),ng(s,i,"threshold"),s},ik=(U=n5,X=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i),a=eC(r,s);return a||(r=iS(s,{attack:r.attack.value,channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,knee:r.knee.value,ratio:r.ratio.value,release:r.release.value,threshold:r.threshold.value})),e.set(s,r),a?(await il(s,i.attack,r.attack),await il(s,i.knee,r.knee),await il(s,i.ratio,r.ratio),await il(s,i.release,r.release),await il(s,i.threshold,r.threshold)):(await iu(s,i.attack,r.attack),await iu(s,i.knee,r.knee),await iu(s,i.ratio,r.ratio),await iu(s,i.release,r.release),await iu(s,i.threshold,r.threshold)),await nH(i,s,r),r})(i,s)}}},class extends U{constructor(e,i){let s=nQ(e),r=iS(s,{...na,...i}),a=nK(s);super(e,!1,r,a?X():null),this._attack=ic(this,a,r.attack),this._knee=ic(this,a,r.knee),this._nativeDynamicsCompressorNode=r,this._ratio=ic(this,a,r.ratio),this._release=ic(this,a,r.release),this._threshold=ic(this,a,r.threshold),im(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){let i=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=i,nM()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){let i=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=i,nM()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}),iO=(Y=n5,Z=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i),a=eC(r,s);return a||(r=nS(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:r.gain.value})),e.set(s,r),a?await il(s,i.gain,r.gain):await iu(s,i.gain,r.gain),await nH(i,s,r),r})(i,s)}}},class extends Y{constructor(e,i){let s=nQ(e),r=nS(s,{...no,...i}),a=nK(s);super(e,!1,r,a?Z():null),this._gain=ic(this,a,r.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}}),iM=(G=()=>{if(null===nJ)return Promise.resolve(!1);let e=new nJ(1,1,44100),i=nS(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{e.oncomplete=()=>{i.disconnect(),s(0!==e.currentTime)},e.startRendering()})},e=>nY(np,()=>np(e))?Promise.resolve(nY(G,G)).then(i=>{if(!i){let i=nO(e,512,0,1);e.oncomplete=()=>{i.onaudioprocess=null,i.disconnect()},i.onaudioprocess=()=>e.currentTime,i.connect(e.destination)}return e.startRendering()}):new Promise(i=>{let s=nS(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.oncomplete=e=>{s.disconnect(),i(e.renderedBuffer)},s.connect(e.destination),e.startRendering()})),iD=($=(e,i,{channelCount:s,channelCountMode:r,channelInterpretation:a,feedback:o,feedforward:l})=>{let h=nx(i,e.sampleRate),u=o instanceof Float64Array?o:new Float64Array(o),c=l instanceof Float64Array?l:new Float64Array(l),d=u.length,p=c.length,f=Math.min(d,p);if(0===d||d>20)throw nM();if(0===u[0])throw nl();if(0===p||p>20)throw nM();if(0===c[0])throw nl();if(1!==u[0]){for(let e=0;e<p;e+=1)c[e]/=u[0];for(let e=1;e<d;e+=1)u[e]/=u[0]}let m=nO(e,h,s,s);m.channelCount=s,m.channelCountMode=r,m.channelInterpretation=a;let _=[],g=[],v=[];for(let e=0;e<s;e+=1){_.push(0);let e=new Float32Array(32),i=new Float32Array(32);e.fill(0),i.fill(0),g.push(e),v.push(i)}m.onaudioprocess=e=>{let i=e.inputBuffer,s=e.outputBuffer,r=i.numberOfChannels;for(let e=0;e<r;e+=1){let r=i.getChannelData(e),a=s.getChannelData(e);_[e]=nc(u,d,c,p,f,g[e],v[e],_[e],32,r,a)}};let y=e.sampleRate/2;return nC({get bufferSize(){return h},get channelCount(){return m.channelCount},set channelCount(t){m.channelCount=t},get channelCountMode(){return m.channelCountMode},set channelCountMode(t){m.channelCountMode=t},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(t){m.channelInterpretation=t},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener:(...e)=>m.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>m.dispatchEvent(e[0]),getFrequencyResponse(e,i,s){if(e.length!==i.length||i.length!==s.length)throw nh();let r=e.length;for(let a=0;a<r;a+=1){let r=-Math.PI*(e[a]/y),o=[Math.cos(r),Math.sin(r)],l=function(e,i){let s=i[0]*i[0]+i[1]*i[1];return[(e[0]*i[0]+e[1]*i[1])/s,(e[1]*i[0]-e[0]*i[1])/s]}(nk(c,o),nk(u,o));i[a]=Math.sqrt(l[0]*l[0]+l[1]*l[1]),s[a]=Math.atan2(l[1],l[0])}},removeEventListener:(...e)=>m.removeEventListener(e[0],e[1],e[2])},m)},(e,i,s)=>{if(void 0===e.createIIRFilter)return $(e,i,s);let r=e.createIIRFilter(s.feedforward,s.feedback);return nm(r,s),r}),iI=(H=n5,Q=(e,i)=>{let s=new WeakMap,r=null,a=async(a,o)=>{let l=null,h=eY(a),u=eC(h,o);if(void 0===o.createIIRFilter?l=ih(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):u||(h=o.createIIRFilter(i,e)),s.set(o,null===l?h:l),null!==l){if(null===r){if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");let s=new nJ(a.context.destination.channelCount,a.context.length,o.sampleRate);r=(async()=>(await nH(a,s,s.destination),((e,i,s,r)=>{let a=s instanceof Float64Array?s:new Float64Array(s),o=r instanceof Float64Array?r:new Float64Array(r),l=a.length,h=o.length,u=Math.min(l,h);if(1!==a[0]){for(let e=0;e<l;e+=1)o[e]/=a[0];for(let e=1;e<h;e+=1)a[e]/=a[0]}let c=new Float32Array(32),d=new Float32Array(32),p=i.createBuffer(e.numberOfChannels,e.length,e.sampleRate),f=e.numberOfChannels;for(let i=0;i<f;i+=1){let s=e.getChannelData(i),r=p.getChannelData(i);c.fill(0),d.fill(0),nc(a,l,o,h,u,c,d,0,32,s,r)}return p})(await iM(s),o,e,i)))()}let s=await r;return l.buffer=s,l.start(0),l}return await nH(a,o,h),h};return{render(e,i){let r=s.get(i);return void 0!==r?Promise.resolve(r):a(e,i)}}},class extends H{constructor(e,i){var s;let r=nQ(e),a=nK(r),o={...nu,...i},l=iD(r,a?null:e.baseLatency,o);super(e,!1,l,a?Q(o.feedback,o.feedforward):null),l.getFrequencyResponse=(s=l.getFrequencyResponse,(e,i,r)=>{if(e.length!==i.length||i.length!==r.length)throw nh();return s.call(l,e,i,r)}),this._nativeIIRFilterNode=l,im(this,1)}getFrequencyResponse(e,i,s){return this._nativeIIRFilterNode.getFrequencyResponse(e,i,s)}}),iE=new WeakMap,iR=(J=(e,i)=>{let s=i.listener,{forwardX:r,forwardY:a,forwardZ:o,positionX:l,positionY:h,positionZ:u,upX:c,upY:d,upZ:p}=void 0===s.forwardX?(()=>{let r=new Float32Array(1),a=iv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),o=nK(i),l=!1,h=[0,0,-1,0,1,0],u=[0,0,0],c=()=>{if(l)return;l=!0;let e=nO(i,256,9,0);e.onaudioprocess=({inputBuffer:e})=>{let i=[nP(e,r,0),nP(e,r,1),nP(e,r,2),nP(e,r,3),nP(e,r,4),nP(e,r,5)];i.some((e,i)=>e!==h[i])&&(s.setOrientation(...i),h=i);let a=[nP(e,r,6),nP(e,r,7),nP(e,r,8)];a.some((e,i)=>e!==u[i])&&(s.setPosition(...a),u=a)},a.connect(e)},d=e=>i=>{i!==h[e]&&(h[e]=i,s.setOrientation(...h))},p=e=>i=>{i!==u[e]&&(u[e]=i,s.setPosition(...u))},f=(s,r,l)=>{var h,u,d,p,f,m,_;let g=iw(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});g.connect(a,0,s),g.start(),Object.defineProperty(g.offset,"defaultValue",{get:()=>r});let v=ic({context:e},o,g.offset,34028234663852886e22,-34028234663852886e22);return nq(v,"value",e=>()=>e.call(v),e=>i=>{try{e.call(v,i)}catch(e){if(9!==e.code)throw e}c(),o&&l(i)}),v.cancelAndHoldAtTime=(h=v.cancelAndHoldAtTime,o?()=>{throw nM()}:(...e)=>{let i=h.apply(v,e);return c(),i}),v.cancelScheduledValues=(u=v.cancelScheduledValues,o?()=>{throw nM()}:(...e)=>{let i=u.apply(v,e);return c(),i}),v.exponentialRampToValueAtTime=(d=v.exponentialRampToValueAtTime,o?()=>{throw nM()}:(...e)=>{let i=d.apply(v,e);return c(),i}),v.linearRampToValueAtTime=(p=v.linearRampToValueAtTime,o?()=>{throw nM()}:(...e)=>{let i=p.apply(v,e);return c(),i}),v.setTargetAtTime=(f=v.setTargetAtTime,o?()=>{throw nM()}:(...e)=>{let i=f.apply(v,e);return c(),i}),v.setValueAtTime=(m=v.setValueAtTime,o?()=>{throw nM()}:(...e)=>{let i=m.apply(v,e);return c(),i}),v.setValueCurveAtTime=(_=v.setValueCurveAtTime,o?()=>{throw nM()}:(...e)=>{let i=_.apply(v,e);return c(),i}),v};return{forwardX:f(0,0,d(0)),forwardY:f(1,0,d(1)),forwardZ:f(2,-1,d(2)),positionX:f(6,0,p(0)),positionY:f(7,0,p(1)),positionZ:f(8,0,p(2)),upX:f(3,0,d(3)),upY:f(4,1,d(4)),upZ:f(5,0,d(5))}})():s;return{get forwardX(){return r},get forwardY(){return a},get forwardZ(){return o},get positionX(){return l},get positionY(){return h},get positionZ(){return u},get upX(){return c},get upY(){return d},get upZ(){return p}}},K=n1,class extends K{constructor(e,i){super(e),this._nativeContext=e,er.set(this,e),nK(e)&&iE.set(e,new Set),this._destination=new ip(this,i),this._listener=J(this,e),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){let i="function"==typeof e?nU(this,e):null;this._nativeContext.onstatechange=i;let s=this._nativeContext.onstatechange;this._onstatechange=null!==s&&s===i?e:s}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}),iN=(e,i)=>{let s=e.createOscillator();return nm(s,i),ng(s,i,"detune"),ng(s,i,"frequency"),void 0!==i.periodicWave?s.setPeriodicWave(i.periodicWave):nf(s,i,"type"),nY(nW,()=>nW(e))||nv(s),nY(nj,()=>nj(e))||nL(s,e),nY(nz,()=>nz(e))||ny(s),ia(e,s),s},iV=(tt=n5,te=()=>{let e=new WeakMap,i=null,s=null,r=null;return{set periodicWave(t){i=t},set start(t){s=t},set stop(t){r=t},render(a,o){let l=e.get(o);return void 0!==l?Promise.resolve(l):(async(a,o)=>{let l=eY(a),h=eC(l,o);return h||(l=iN(o,{channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,periodicWave:null===i?void 0:i,type:l.type}),null!==s&&l.start(s),null!==r&&l.stop(r)),e.set(o,l),h?(await il(o,a.detune,l.detune),await il(o,a.frequency,l.frequency)):(await iu(o,a.detune,l.detune),await iu(o,a.frequency,l.frequency)),await nH(a,o,l),l})(a,o)}}},class extends tt{constructor(e,i){let s=nQ(e),r={...nI,...i},a=iN(s,r),o=nK(s),l=o?te():null,h=e.sampleRate/2;super(e,!1,a,l),this._detune=ic(this,o,a.detune,153600,-153600),this._frequency=ic(this,o,a.frequency,h,-h),this._nativeOscillatorNode=a,this._onended=null,this._oscillatorNodeRenderer=l,null!==this._oscillatorNodeRenderer&&void 0!==r.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=r.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){let i="function"==typeof e?nU(this,e):null;this._nativeOscillatorNode.onended=i;let s=this._nativeOscillatorNode.onended;this._onended=null!==s&&s===i?e:s}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){ey(this);let e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),eM(this)&&ew(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}),iP=(e,i)=>{let s=ih(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return s.buffer=r,s.loop=!0,s.connect(i),s.start(),()=>{s.stop(),s.disconnect(i)}},iF=(tn=(e,{curve:i,oversample:s,...r})=>{let a=e.createWaveShaper(),o=e.createWaveShaper();nm(a,r),nm(o,r);let l=nS(e,{...r,gain:1}),h=nS(e,{...r,gain:-1}),u=nS(e,{...r,gain:1}),c=nS(e,{...r,gain:-1}),d=null,p=!1,f=null,m={get bufferSize(){},get channelCount(){return a.channelCount},set channelCount(t){l.channelCount=t,h.channelCount=t,a.channelCount=t,u.channelCount=t,o.channelCount=t,c.channelCount=t},get channelCountMode(){return a.channelCountMode},set channelCountMode(t){l.channelCountMode=t,h.channelCountMode=t,a.channelCountMode=t,u.channelCountMode=t,o.channelCountMode=t,c.channelCountMode=t},get channelInterpretation(){return a.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t,h.channelInterpretation=t,a.channelInterpretation=t,u.channelInterpretation=t,o.channelInterpretation=t,c.channelInterpretation=t},get context(){return a.context},get curve(){return f},set curve(n){if(null!==n&&n.length<2)throw nl();if(null===n)a.curve=n,o.curve=n;else{let e=n.length,i=new Float32Array(e+2-e%2),s=new Float32Array(e+2-e%2);i[0]=n[0],s[0]=-n[e-1];let r=Math.ceil((e+1)/2),l=(e+1)/2-1;for(let a=1;a<r;a+=1){let o=a/r*l,h=Math.floor(o),u=Math.ceil(o);i[a]=h===u?n[h]:(1-(o-h))*n[h]+(1-(u-o))*n[u],s[a]=h===u?-n[e-1-h]:-(1-(o-h))*n[e-1-h]-(1-(u-o))*n[e-1-u]}i[r]=e%2==1?n[r-1]:(n[r-2]+n[r-1])/2,a.curve=i,o.curve=s}f=n,p&&(nF(f)&&null===d?d=iP(e,l):null!==d&&(d(),d=null))},get inputs(){return[l]},get numberOfInputs(){return a.numberOfInputs},get numberOfOutputs(){return a.numberOfOutputs},get oversample(){return a.oversample},set oversample(t){a.oversample=t,o.oversample=t},addEventListener:(...e)=>l.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>l.dispatchEvent(e[0]),removeEventListener:(...e)=>l.removeEventListener(e[0],e[1],e[2])};return null!==i&&(m.curve=i instanceof Float32Array?i:new Float32Array(i)),s!==m.oversample&&(m.oversample=s),ig(nC(m,u),()=>{l.connect(a).connect(u),l.connect(h).connect(o).connect(c).connect(u),p=!0,nF(f)&&(d=iP(e,l))},()=>{l.disconnect(a),a.disconnect(u),l.disconnect(h),h.disconnect(o),o.disconnect(c),c.disconnect(u),p=!1,null!==d&&(d(),d=null)})},(e,i)=>{let s=e.createWaveShaper();if(null!==n2&&"webkitAudioContext"===n2.name&&void 0===e.createGain().gain.automationRate)return tn(e,i);nm(s,i);let r=null===i.curve||i.curve instanceof Float32Array?i.curve:new Float32Array(i.curve);if(null!==r&&r.length<2)throw nl();nf(s,{curve:r},"curve"),nf(s,i,"oversample");let a=null,o=!1;return nq(s,"curve",e=>()=>e.call(s),i=>r=>(i.call(s,r),o&&(nF(r)&&null===a?a=iP(e,s):nF(r)||null===a||(a(),a=null)),r)),ig(s,()=>{o=!0,nF(s.curve)&&(a=iP(e,s))},()=>{o=!1,null!==a&&(a(),a=null)})}),iq=(ti=(e,{coneInnerAngle:i,coneOuterAngle:s,coneOuterGain:r,distanceModel:a,maxDistance:o,orientationX:l,orientationY:h,orientationZ:u,panningModel:c,positionX:d,positionY:p,positionZ:f,refDistance:m,rolloffFactor:_,...g})=>{let v=e.createPanner();if(g.channelCount>2||"max"===g.channelCountMode)throw nM();nm(v,g);let y={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},x=iv(e,{...y,channelInterpretation:"speakers",numberOfInputs:6}),w=nS(e,{...g,gain:1}),T=nS(e,{...y,gain:1}),b=nS(e,{...y,gain:0}),C=nS(e,{...y,gain:0}),A=nS(e,{...y,gain:0}),S=nS(e,{...y,gain:0}),k=nS(e,{...y,gain:0}),O=nO(e,256,6,1),M=iF(e,{...y,curve:new Float32Array([1,1]),oversample:"none"}),D=[l,h,u],I=[d,p,f],E=new Float32Array(1);O.onaudioprocess=({inputBuffer:e})=>{let i=[nP(e,E,0),nP(e,E,1),nP(e,E,2)];i.some((e,i)=>e!==D[i])&&(v.setOrientation(...i),D=i);let s=[nP(e,E,3),nP(e,E,4),nP(e,E,5)];s.some((e,i)=>e!==I[i])&&(v.setPosition(...s),I=s)},Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(S.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0});let R={get bufferSize(){},get channelCount(){return v.channelCount},set channelCount(t){if(t>2)throw nM();w.channelCount=t,v.channelCount=t},get channelCountMode(){return v.channelCountMode},set channelCountMode(t){if("max"===t)throw nM();w.channelCountMode=t,v.channelCountMode=t},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(t){w.channelInterpretation=t,v.channelInterpretation=t},get coneInnerAngle(){return v.coneInnerAngle},set coneInnerAngle(t){v.coneInnerAngle=t},get coneOuterAngle(){return v.coneOuterAngle},set coneOuterAngle(t){v.coneOuterAngle=t},get coneOuterGain(){return v.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw nl();v.coneOuterGain=t},get context(){return v.context},get distanceModel(){return v.distanceModel},set distanceModel(t){v.distanceModel=t},get inputs(){return[w]},get maxDistance(){return v.maxDistance},set maxDistance(t){if(t<0)throw RangeError();v.maxDistance=t},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get orientationX(){return T.gain},get orientationY(){return b.gain},get orientationZ(){return C.gain},get panningModel(){return v.panningModel},set panningModel(t){v.panningModel=t},get positionX(){return A.gain},get positionY(){return S.gain},get positionZ(){return k.gain},get refDistance(){return v.refDistance},set refDistance(t){if(t<0)throw RangeError();v.refDistance=t},get rolloffFactor(){return v.rolloffFactor},set rolloffFactor(t){if(t<0)throw RangeError();v.rolloffFactor=t},addEventListener:(...e)=>w.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>w.dispatchEvent(e[0]),removeEventListener:(...e)=>w.removeEventListener(e[0],e[1],e[2])};return i!==R.coneInnerAngle&&(R.coneInnerAngle=i),s!==R.coneOuterAngle&&(R.coneOuterAngle=s),r!==R.coneOuterGain&&(R.coneOuterGain=r),a!==R.distanceModel&&(R.distanceModel=a),o!==R.maxDistance&&(R.maxDistance=o),l!==R.orientationX.value&&(R.orientationX.value=l),h!==R.orientationY.value&&(R.orientationY.value=h),u!==R.orientationZ.value&&(R.orientationZ.value=u),c!==R.panningModel&&(R.panningModel=c),d!==R.positionX.value&&(R.positionX.value=d),p!==R.positionY.value&&(R.positionY.value=p),f!==R.positionZ.value&&(R.positionZ.value=f),m!==R.refDistance&&(R.refDistance=m),_!==R.rolloffFactor&&(R.rolloffFactor=_),1===D[0]&&0===D[1]&&0===D[2]||v.setOrientation(...D),0===I[0]&&0===I[1]&&0===I[2]||v.setPosition(...I),ig(nC(R,v),()=>{w.connect(v),ej(w,M,0,0),M.connect(T).connect(x,0,0),M.connect(b).connect(x,0,1),M.connect(C).connect(x,0,2),M.connect(A).connect(x,0,3),M.connect(S).connect(x,0,4),M.connect(k).connect(x,0,5),x.connect(O).connect(e.destination)},()=>{w.disconnect(v),eX(w,M,0,0),M.disconnect(T),T.disconnect(x),M.disconnect(b),b.disconnect(x),M.disconnect(C),C.disconnect(x),M.disconnect(A),A.disconnect(x),M.disconnect(S),S.disconnect(x),M.disconnect(k),k.disconnect(x),x.disconnect(O),O.disconnect(e.destination)})},(e,i)=>{let s=e.createPanner();return void 0===s.orientationX?ti(e,i):(nm(s,i),ng(s,i,"orientationX"),ng(s,i,"orientationY"),ng(s,i,"orientationZ"),ng(s,i,"positionX"),ng(s,i,"positionY"),ng(s,i,"positionZ"),nf(s,i,"coneInnerAngle"),nf(s,i,"coneOuterAngle"),nf(s,i,"coneOuterGain"),nf(s,i,"distanceModel"),nf(s,i,"maxDistance"),nf(s,i,"panningModel"),nf(s,i,"refDistance"),nf(s,i,"rolloffFactor"),s)}),iB=(ts=n5,tr=()=>{let e=new WeakMap,i=null;return{render(s,r){let a=e.get(r);return void 0!==a?Promise.resolve(a):(async(s,r)=>{let a=null,o=eY(s),l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation},h={...l,coneInnerAngle:o.coneInnerAngle,coneOuterAngle:o.coneOuterAngle,coneOuterGain:o.coneOuterGain,distanceModel:o.distanceModel,maxDistance:o.maxDistance,panningModel:o.panningModel,refDistance:o.refDistance,rolloffFactor:o.rolloffFactor},u=eC(o,r);if("bufferSize"in o?a=nS(r,{...l,gain:1}):u||(o=iq(r,{...h,orientationX:o.orientationX.value,orientationY:o.orientationY.value,orientationZ:o.orientationZ.value,positionX:o.positionX.value,positionY:o.positionY.value,positionZ:o.positionZ.value})),e.set(r,null===a?o:a),null!==a){if(null===i){if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");let e=new nJ(6,s.context.length,r.sampleRate),a=iv(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});a.connect(e.destination),i=(async()=>{let i=await Promise.all([s.orientationX,s.orientationY,s.orientationZ,s.positionX,s.positionY,s.positionZ].map(async(i,s)=>{let r=iw(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:+(0===s)});return await iu(e,i,r.offset),r}));for(let e=0;e<6;e+=1)i[e].connect(a,0,e),i[e].start(0);return iM(e)})()}let e=await i,o=nS(r,{...l,gain:1});await nH(s,r,o);let u=[];for(let i=0;i<e.numberOfChannels;i+=1)u.push(e.getChannelData(i));let c=[u[0][0],u[1][0],u[2][0]],d=[u[3][0],u[4][0],u[5][0]],p=nS(r,{...l,gain:1}),f=iq(r,{...h,orientationX:c[0],orientationY:c[1],orientationZ:c[2],positionX:d[0],positionY:d[1],positionZ:d[2]});o.connect(p).connect(f.inputs[0]),f.connect(a);for(let i=128;i<e.length;i+=128){let e=[u[0][i],u[1][i],u[2][i]],s=[u[3][i],u[4][i],u[5][i]];if(e.some((e,i)=>e!==c[i])||s.some((e,i)=>e!==d[i])){c=e,d=s;let u=i/r.sampleRate;p.gain.setValueAtTime(0,u),p=nS(r,{...l,gain:0}),f=iq(r,{...h,orientationX:c[0],orientationY:c[1],orientationZ:c[2],positionX:d[0],positionY:d[1],positionZ:d[2]}),p.gain.setValueAtTime(1,u),o.connect(p).connect(f.inputs[0]),f.connect(a)}}return a}return u?(await il(r,s.orientationX,o.orientationX),await il(r,s.orientationY,o.orientationY),await il(r,s.orientationZ,o.orientationZ),await il(r,s.positionX,o.positionX),await il(r,s.positionY,o.positionY),await il(r,s.positionZ,o.positionZ)):(await iu(r,s.orientationX,o.orientationX),await iu(r,s.orientationY,o.orientationY),await iu(r,s.orientationZ,o.orientationZ),await iu(r,s.positionX,o.positionX),await iu(r,s.positionY,o.positionY),await iu(r,s.positionZ,o.positionZ)),eW(o)?await nH(s,r,o.inputs[0]):await nH(s,r,o),o})(s,r)}}},class extends ts{constructor(e,i){let s=nQ(e),r=iq(s,{...nE,...i}),a=nK(s);super(e,!1,r,a?tr():null),this._nativePannerNode=r,this._orientationX=ic(this,a,r.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=ic(this,a,r.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=ic(this,a,r.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=ic(this,a,r.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=ic(this,a,r.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=ic(this,a,r.positionZ,34028234663852886e22,-34028234663852886e22),im(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}}),iW=(ta=(e,{disableNormalization:i,imag:s,real:r})=>{let a=s instanceof Float32Array?s:new Float32Array(s),o=r instanceof Float32Array?r:new Float32Array(r),l=e.createPeriodicWave(o,a,{disableNormalization:i});if(Array.from(s).length<2)throw eS();return l},to=new WeakSet,tl=e=>{let{imag:i,real:s}=e;return void 0===i?void 0===s?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(s,()=>0),real:s}:void 0===s?{...e,imag:i,real:Array.from(i,()=>0)}:{...e,imag:i,real:s}},class e{constructor(e,i){let s=ta(nQ(e),tl({...nR,...i}));return to.add(s),s}static[Symbol.hasInstance](i){return null!==i&&"object"==typeof i&&Object.getPrototypeOf(i)===e.prototype||to.has(i)}}),ij=(th=((e,i,s,r,a,o)=>{let l=new Float32Array([1,1]),h=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c={...u,oversample:"none"},d=(e,o,d,p,f)=>{if(1===o)return((e,i,a,o)=>{let d=new Float32Array(16385),p=new Float32Array(16385);for(let e=0;e<16385;e+=1){let i=e/16384*h;d[e]=Math.cos(i),p[e]=Math.sin(i)}let f=s(e,{...u,gain:0}),m=r(e,{...c,curve:d}),_=r(e,{...c,curve:l}),g=s(e,{...u,gain:0}),v=r(e,{...c,curve:p});return{connectGraph(){i.connect(f),i.connect(void 0===_.inputs?_:_.inputs[0]),i.connect(g),_.connect(a),a.connect(void 0===m.inputs?m:m.inputs[0]),a.connect(void 0===v.inputs?v:v.inputs[0]),m.connect(f.gain),v.connect(g.gain),f.connect(o,0,0),g.connect(o,0,1)},disconnectGraph(){i.disconnect(f),i.disconnect(void 0===_.inputs?_:_.inputs[0]),i.disconnect(g),_.disconnect(a),a.disconnect(void 0===m.inputs?m:m.inputs[0]),a.disconnect(void 0===v.inputs?v:v.inputs[0]),m.disconnect(f.gain),v.disconnect(g.gain),f.disconnect(o,0,0),g.disconnect(o,0,1)}}})(e,d,p,f);if(2===o)return((e,a,o,d)=>{let p=new Float32Array(16385),f=new Float32Array(16385),m=new Float32Array(16385),_=new Float32Array(16385),g=Math.floor(8192.5);for(let e=0;e<16385;e+=1)if(e>g){let i=(e-g)/(16384-g)*h;p[e]=Math.cos(i),f[e]=Math.sin(i),m[e]=0,_[e]=1}else{let i=e/(16384-g)*h;p[e]=1,f[e]=0,m[e]=Math.cos(i),_[e]=Math.sin(i)}let v=i(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=s(e,{...u,gain:0}),x=r(e,{...c,curve:p}),w=s(e,{...u,gain:0}),T=r(e,{...c,curve:f}),b=r(e,{...c,curve:l}),C=s(e,{...u,gain:0}),A=r(e,{...c,curve:m}),S=s(e,{...u,gain:0}),k=r(e,{...c,curve:_});return{connectGraph(){a.connect(v),a.connect(void 0===b.inputs?b:b.inputs[0]),v.connect(y,0),v.connect(w,0),v.connect(C,1),v.connect(S,1),b.connect(o),o.connect(void 0===x.inputs?x:x.inputs[0]),o.connect(void 0===T.inputs?T:T.inputs[0]),o.connect(void 0===A.inputs?A:A.inputs[0]),o.connect(void 0===k.inputs?k:k.inputs[0]),x.connect(y.gain),T.connect(w.gain),A.connect(C.gain),k.connect(S.gain),y.connect(d,0,0),C.connect(d,0,0),w.connect(d,0,1),S.connect(d,0,1)},disconnectGraph(){a.disconnect(v),a.disconnect(void 0===b.inputs?b:b.inputs[0]),v.disconnect(y,0),v.disconnect(w,0),v.disconnect(C,1),v.disconnect(S,1),b.disconnect(o),o.disconnect(void 0===x.inputs?x:x.inputs[0]),o.disconnect(void 0===T.inputs?T:T.inputs[0]),o.disconnect(void 0===A.inputs?A:A.inputs[0]),o.disconnect(void 0===k.inputs?k:k.inputs[0]),x.disconnect(y.gain),T.disconnect(w.gain),A.disconnect(C.gain),k.disconnect(S.gain),y.disconnect(d,0,0),C.disconnect(d,0,0),w.disconnect(d,0,1),S.disconnect(d,0,1)}}})(e,d,p,f);throw a()};return(i,{channelCount:r,channelCountMode:l,pan:h,...u})=>{if("max"===l)throw a();let c=e(i,{...u,channelCount:1,channelCountMode:l,numberOfInputs:2}),p=s(i,{...u,channelCount:r,channelCountMode:l,gain:1}),f=s(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:h}),{connectGraph:m,disconnectGraph:_}=d(i,r,p,f,c);Object.defineProperty(f.gain,"defaultValue",{get:()=>0}),Object.defineProperty(f.gain,"maxValue",{get:()=>1}),Object.defineProperty(f.gain,"minValue",{get:()=>-1});let g=!1;return o(nC({get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(t){p.channelCount!==t&&(g&&_(),{connectGraph:m,disconnectGraph:_}=d(i,t,p,f,c),g&&m()),p.channelCount=t},get channelCountMode(){return p.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw a();p.channelCountMode=t},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(t){p.channelInterpretation=t},get context(){return p.context},get inputs(){return[p]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get pan(){return f.gain},addEventListener:(...e)=>p.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>p.dispatchEvent(e[0]),removeEventListener:(...e)=>p.removeEventListener(e[0],e[1],e[2])},c),()=>{m(),g=!0},()=>{_(),g=!1})}})(iv,nb,nS,iF,nM,ig),(e,i)=>{let s=i.channelCountMode;if("clamped-max"===s)throw nM();if(void 0===e.createStereoPanner)return th(e,i);let r=e.createStereoPanner();return nm(r,i),ng(r,i,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:e=>{if(e!==s)throw nM()}}),r}),iz=(tu=n5,tc=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i),a=eC(r,s);return a||(r=ij(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,pan:r.pan.value})),e.set(s,r),a?await il(s,i.pan,r.pan):await iu(s,i.pan,r.pan),eW(r)?await nH(i,s,r.inputs[0]):await nH(i,s,r),r})(i,s)}}},class extends tu{constructor(e,i){let s=nQ(e),r=ij(s,{...nN,...i}),a=nK(s);super(e,!1,r,a?tc():null),this._pan=ic(this,a,r.pan)}get pan(){return this._pan}}),iL=(td=n5,tp=()=>{let e=new WeakMap;return{render(i,s){let r=e.get(s);return void 0!==r?Promise.resolve(r):(async(i,s)=>{let r=eY(i);return eC(r,s)||(r=iF(s,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,curve:r.curve,oversample:r.oversample})),e.set(s,r),eW(r)?await nH(i,s,r.inputs[0]):await nH(i,s,r),r})(i,s)}}},class extends td{constructor(e,i){let s=nQ(e),r=iF(s,{...nV,...i});super(e,!0,r,nK(s)?tp():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=r,im(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw nl();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}}),iU=null!==nZ&&nZ.isSecureContext,iX=(e,i,s)=>{Object.defineProperties(nZ,{currentFrame:{configurable:!0,get:()=>Math.round(e*i)},currentTime:{configurable:!0,get:()=>e}});try{return s()}finally{null!==nZ&&(delete nZ.currentFrame,delete nZ.currentTime)}},iY=new WeakMap,iZ=iU?(rD=e=>new Promise((i,s)=>{if(null===nZ)return void s(SyntaxError());let r=nZ.document.head;if(null===r)s(SyntaxError());else{let a=nZ.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),l=URL.createObjectURL(o),h=nZ.onerror,u=()=>{nZ.onerror=h,URL.revokeObjectURL(l)};nZ.onerror=(e,i,r,a,o)=>i===l||i===nZ.location.href&&1===r&&1===a?(u(),s(o),!1):null!==h?h(e,i,r,a,o):void 0,a.onerror=()=>{u(),s(SyntaxError())},a.onload=()=>{u(),i()},a.src=l,a.type="module",r.appendChild(a)}}),tf=()=>new DOMException("","AbortError"),rI=async e=>{try{let i=await fetch(e);if(i.ok)return[await i.text(),i.url]}catch{}throw tf()},rE=e=>{let i=iY.get(e);if(void 0!==i)return i;if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");return i=new nJ(1,1,44100),iY.set(e,i),i},rR=new WeakMap,rN=new WeakMap,rV=async()=>{if(null===n4)return!0;if(null===nJ)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new nJ(1,128,44100),s=URL.createObjectURL(e),r=!1,a=!1;try{await i.audioWorklet.addModule(s);let e=new n4(i,"a",{numberOfOutputs:0}),o=i.createOscillator();e.port.onmessage=()=>r=!0,e.onprocessorerror=()=>a=!0,o.connect(e),o.start(0),await i.startRendering(),await new Promise(e=>setTimeout(e))}catch{}finally{URL.revokeObjectURL(s)}return r&&!a},tm=0,(e,i,s={credentials:"omit"})=>{let r=rN.get(e);if(void 0!==r&&r.has(i))return Promise.resolve();let a=rR.get(e);if(void 0!==a){let e=a.get(i);if(void 0!==e)return e}let o=nQ(e),l=void 0===o.audioWorklet?rI(i).then(([e,i])=>{let[s,r]=ed(e,i);return rD(`${s};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}
})})(window,'_AWGS')`)}).then(()=>{let e=nZ._AWGS.pop();if(void 0===e)throw SyntaxError();iX(o.currentTime,o.sampleRate,()=>e(class{},void 0,(e,i)=>{if(""===e.trim())throw nM();let s=el.get(o);if(void 0!==s){if(s.has(e))throw nM();ef(i),ep(i.parameterDescriptors),s.set(e,i)}else ef(i),ep(i.parameterDescriptors),el.set(o,new Map([[e,i]]))},o.sampleRate,void 0,void 0))}):Promise.all([rI(i),Promise.resolve(nY(rV,rV))]).then(([[e,i],r])=>{let a=tm+1;tm=a;let[l,h]=ed(e,i),u=new Blob([`${l};((AudioWorkletProcessor,registerProcessor)=>{${h}
})(${r?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${r?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${r?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${a}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(u);return o.audioWorklet.addModule(c,s).then(()=>{if(nK(o))return o;let e=rE(o);return e.audioWorklet.addModule(c,s).then(()=>e)}).then(e=>{if(null===n4)throw SyntaxError();try{new n4(e,`__sac${a}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(c))});return void 0===a?rR.set(e,new Map([[i,l]])):a.set(i,l),l.then(()=>{let s=rN.get(e);void 0===s?rN.set(e,new Set([i])):s.add(i)}).finally(()=>{let s=rR.get(e);void 0!==s&&s.delete(i)}),l}):void 0,iG=(t_=()=>new DOMException("","DataCloneError"),tg=()=>new DOMException("","EncodingError"),tv=new WeakSet,ty=e=>n3(e)||nK(e),(e,i)=>{let s=ty(e)?e:nQ(e);if(tv.has(i))return Promise.reject(t_());try{tv.add(i)}catch{}return nY(np,()=>np(s))?s.decodeAudioData(i).then(e=>(ni(i).catch(()=>{}),nY(eA,()=>eA(e))||is(e),n7.add(e),e)):new Promise((e,r)=>{let a=async()=>{try{await ni(i)}catch{}},o=e=>{r(e),a()};try{s.decodeAudioData(i,i=>{"function"!=typeof i.copyFromChannel&&(ii(i),ek(i)),n7.add(i),a().then(()=>e(i))},e=>{o(null===e?tg():e)})}catch(e){o(e)}})}),i$=(tx=iR,class extends tx{constructor(e,i){super(e,i),this._nativeContext=e,this._audioWorklet=void 0===iZ?void 0:{addModule:(e,i)=>iZ(this,e,i)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new n9(this)}createBiquadFilter(){return new i_(this)}createBuffer(e,i,s){return new ir({length:i,numberOfChannels:e,sampleRate:s})}createBufferSource(){return new id(this)}createChannelMerger(e=6){return new iy(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new ix(this,{numberOfOutputs:e})}createConstantSource(){return new iT(this)}createConvolver(){return new iC(this)}createDelay(e=1){return new iA(this,{maxDelayTime:e})}createDynamicsCompressor(){return new ik(this)}createGain(){return new iO(this)}createIIRFilter(e,i){return new iI(this,{feedback:i,feedforward:e})}createOscillator(){return new iV(this)}createPanner(){return new iB(this)}createPeriodicWave(e,i,s={disableNormalization:!1}){return new iW(this,{...s,imag:i,real:e})}createStereoPanner(){return new iz(this)}createWaveShaper(){return new iL(this)}decodeAudioData(e,i,s){return iG(this._nativeContext,e).then(e=>("function"==typeof i&&i(e),e),e=>{throw"function"==typeof s&&s(e),e})}}),iH=(tw=n5,tT=(e,i)=>e.createMediaElementSource(i.mediaElement),class extends tw{constructor(e,i){let s=nQ(e),r=tT(s,i);if(nK(s))throw TypeError();super(e,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}}),iQ=(tb=n5,tC=(e,i)=>{let s=e.createMediaStreamDestination();return nm(s,i),1===s.numberOfOutputs&&Object.defineProperty(s,"numberOfOutputs",{get:()=>0}),s},class extends tb{constructor(e,i){let s=nQ(e);if(nK(s))throw TypeError();let r=tC(s,{...nd,...i});super(e,!1,r,null),this._nativeMediaStreamAudioDestinationNode=r}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}),iJ=(tA=n5,tS=(e,{mediaStream:i})=>{let s=i.getAudioTracks();s.sort((e,i)=>e.id<i.id?-1:+(e.id>i.id));let r=s.slice(0,1),a=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(a,"mediaStream",{value:i}),a},class extends tA{constructor(e,i){let s=nQ(e),r=tS(s,i);if(nK(s))throw TypeError();super(e,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}),iK=(tk=n5,tO=(e,{mediaStreamTrack:i})=>{if("function"==typeof e.createMediaStreamTrackSource)return e.createMediaStreamTrackSource(i);let s=new MediaStream([i]),r=e.createMediaStreamSource(s);if("audio"!==i.kind)throw nl();if(nK(e))throw TypeError();return r},class extends tk{constructor(e,i){super(e,!0,tO(nQ(e),i),null)}}),i0=(tM=i$,tD=()=>new DOMException("","UnknownError"),class extends tM{constructor(e={}){let i,s;if(null===n2)throw Error("Missing the native AudioContext constructor.");try{i=new n2(e)}catch(e){if(12===e.code&&"sampleRate is not in range"===e.message)throw nM();throw e}if(null===i)throw tD();if(void 0!==(s=e.latencyHint)&&"number"!=typeof s&&("string"!=typeof s||"balanced"!==s&&"interactive"!==s&&"playback"!==s))throw TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&i.sampleRate!==e.sampleRate)throw nM();super(i,2);let{latencyHint:r}=e,{sampleRate:a}=i;if(this._baseLatency="number"==typeof i.baseLatency?i.baseLatency:"balanced"===r?512/a:"interactive"===r||void 0===r?256/a:"playback"===r?1024/a:128*Math.max(2,Math.min(128,Math.round(r*a/128)))/a,this._nativeAudioContext=i,"webkitAudioContext"===n2.name?(this._nativeGainNode=i.createGain(),this._nativeOscillatorNode=i.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(i.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===i.state){this._state="suspended";let e=()=>{"suspended"===this._state&&(this._state=null),i.removeEventListener("statechange",e)};i.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw nl()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),eN(this)}))}createMediaElementSource(e){return new iH(this,{mediaElement:e})}createMediaStreamDestination(){return new iQ(this)}createMediaStreamSource(e){return new iJ(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new iK(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise((e,i)=>{let s=()=>{this._nativeAudioContext.removeEventListener("statechange",s),"running"===this._nativeAudioContext.state?e():this.resume().then(e,i)};this._nativeAudioContext.addEventListener("statechange",s)}):this._nativeAudioContext.resume().catch(e=>{if(void 0===e||15===e.code)throw nl();throw e})}suspend(){return this._nativeAudioContext.suspend().catch(e=>{if(void 0===e)throw nl();throw e})}}),i1=e=>{let i=iE.get(e);if(void 0===i)throw Error("The context has no set of AudioWorkletNodes.");return i},i2=(e,i,s=0,r=0)=>{let a=e[s];if(void 0===a)throw eS();return eJ(i)?a.connect(i,0,r):a.connect(i,0)},i3=(e,i,s,r=0)=>void 0===i?e.forEach(e=>e.disconnect()):"number"==typeof i?nr(eS,e,i).disconnect():eJ(i)?void 0===s?e.forEach(e=>e.disconnect(i)):void 0===r?nr(eS,e,s).disconnect(i,0):nr(eS,e,s).disconnect(i,0,r):void 0===s?e.forEach(e=>e.disconnect(i)):nr(eS,e,s).disconnect(i,0),i8=new WeakMap,i6=(tI=e=>em(i8,e),(e,i,s,r)=>{var a,o;if(0===r.numberOfInputs&&0===r.numberOfOutputs)throw nM();let l=Array.isArray(r.outputChannelCount)?r.outputChannelCount:Array.from(r.outputChannelCount);if(l.some(e=>e<1))throw nM();if(l.length!==r.numberOfOutputs)throw eS();if("explicit"!==r.channelCountMode)throw nM();let h=r.channelCount*r.numberOfInputs,u=l.reduce((e,i)=>e+i,0),c=void 0===s.parameterDescriptors?0:s.parameterDescriptors.length;if(h+c>6||u>6)throw nM();let d=new MessageChannel,p=[],f=[];for(let i=0;i<r.numberOfInputs;i+=1)p.push(nS(e,{channelCount:r.channelCount,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1})),f.push(nb(e,{channelCount:r.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:r.channelCount}));let m=[];if(void 0!==s.parameterDescriptors)for(let{defaultValue:i,maxValue:a,minValue:o,name:l}of s.parameterDescriptors){let s=iw(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==r.parameterData[l]?r.parameterData[l]:void 0===i?0:i});Object.defineProperties(s.offset,{defaultValue:{get:()=>void 0===i?0:i},maxValue:{get:()=>void 0===a?34028234663852886e22:a},minValue:{get:()=>void 0===o?-34028234663852886e22:o}}),m.push(s)}let _=iv(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,h+c)}),g=nx(i,e.sampleRate),v=nO(e,g,h+c,Math.max(1,u)),y=nb(e,{channelCount:Math.max(1,u),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,u)}),x=[];for(let i=0;i<r.numberOfOutputs;i+=1)x.push(iv(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:l[i]}));for(let e=0;e<r.numberOfInputs;e+=1){p[e].connect(f[e]);for(let i=0;i<r.channelCount;i+=1)f[e].connect(_,i,e*r.channelCount+i)}let w=new e2(void 0===s.parameterDescriptors?[]:s.parameterDescriptors.map(({name:e},i)=>{let s=m[i];return s.connect(_,0,h+i),s.start(0),[e,s.offset]}));_.connect(v);let T=r.channelInterpretation,b=null,C=0===r.numberOfOutputs?[v]:x,A={get bufferSize(){return g},get channelCount(){return r.channelCount},set channelCount(t){throw nl()},get channelCountMode(){return r.channelCountMode},set channelCountMode(t){throw nl()},get channelInterpretation(){return T},set channelInterpretation(t){for(let e of p)e.channelInterpretation=t;T=t},get context(){return v.context},get inputs(){return p},get numberOfInputs(){return r.numberOfInputs},get numberOfOutputs(){return r.numberOfOutputs},get onprocessorerror(){return b},set onprocessorerror(t){"function"==typeof b&&A.removeEventListener("processorerror",b),"function"==typeof(b="function"==typeof t?t:null)&&A.addEventListener("processorerror",b)},get parameters(){return w},get port(){return d.port2},addEventListener:(...e)=>v.addEventListener(e[0],e[1],e[2]),connect:i2.bind(null,C),disconnect:i3.bind(null,C),dispatchEvent:(...e)=>v.dispatchEvent(e[0]),removeEventListener:(...e)=>v.removeEventListener(e[0],e[1],e[2])},S=new Map;d.port1.addEventListener=(a=d.port1.addEventListener,(...i)=>{if("message"===i[0]){let s="function"==typeof i[1]?i[1]:"object"==typeof i[1]&&null!==i[1]&&"function"==typeof i[1].handleEvent?i[1].handleEvent:null;if(null!==s){let r=S.get(i[1]);void 0!==r?i[1]=r:(i[1]=i=>{iX(e.currentTime,e.sampleRate,()=>s(i))},S.set(s,i[1]))}}return a.call(d.port1,i[0],i[1],i[2])}),d.port1.removeEventListener=(o=d.port1.removeEventListener,(...e)=>{if("message"===e[0]){let i=S.get(e[1]);void 0!==i&&(S.delete(e[1]),e[1]=i)}return o.call(d.port1,e[0],e[1],e[2])});let k=null;Object.defineProperty(d.port1,"onmessage",{get:()=>k,set:e=>{"function"==typeof k&&d.port1.removeEventListener("message",k),"function"==typeof(k="function"==typeof e?e:null)&&(d.port1.addEventListener("message",k),d.port1.start())}}),s.prototype.port=d.port1;let O=null;((e,i,s,r)=>{let a=eh.get(e);void 0===a&&(a=new WeakMap,eh.set(e,a));let o=nw(s,r);return a.set(i,o),o})(e,A,s,r).then(e=>O=e);let M=e4(r.numberOfInputs,r.channelCount),D=e4(r.numberOfOutputs,l),I=void 0===s.parameterDescriptors?[]:s.parameterDescriptors.reduce((e,{name:i})=>({...e,[i]:new Float32Array(128)}),{}),E=!0,R=()=>{r.numberOfOutputs>0&&v.disconnect(y);for(let e=0,i=0;e<r.numberOfOutputs;e+=1){let s=x[e];for(let r=0;r<l[e];r+=1)y.disconnect(s,i+r,r);i+=l[e]}},N=new Map;v.onaudioprocess=({inputBuffer:i,outputBuffer:a})=>{if(null!==O){let o=tI(A);for(let u=0;u<g;u+=128){for(let e=0;e<r.numberOfInputs;e+=1)for(let s=0;s<r.channelCount;s+=1)e8(i,M[e],s,s,u);void 0!==s.parameterDescriptors&&s.parameterDescriptors.forEach(({name:e},s)=>{e8(i,I,e,h+s,u)});for(let e=0;e<r.numberOfInputs;e+=1)for(let i=0;i<l[e];i+=1)0===D[e][i].byteLength&&(D[e][i]=new Float32Array(128));try{let i=M.map((e,i)=>{if(o[i].size>0)return N.set(i,g/128),e;let s=N.get(i);return void 0===s?[]:(e.every(e=>e.every(e=>0===e))&&(1===s?N.delete(i):N.set(i,s-1)),e)});E=iX(e.currentTime+u/e.sampleRate,e.sampleRate,()=>O.process(i,D,I));for(let e=0,i=0;e<r.numberOfOutputs;e+=1){for(let s=0;s<l[e];s+=1)e6(a,D[e],s,i+s,u);i+=l[e]}}catch(e){E=!1,A.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}))}if(!E){for(let e=0;e<r.numberOfInputs;e+=1){p[e].disconnect(f[e]);for(let i=0;i<r.channelCount;i+=1)f[u].disconnect(_,i,e*r.channelCount+i)}if(void 0!==s.parameterDescriptors){let e=s.parameterDescriptors.length;for(let i=0;i<e;i+=1){let e=m[i];e.disconnect(_,0,h+i),e.stop()}}_.disconnect(v),v.onaudioprocess=null,V?R():q();break}}}};let V=!1,P=nS(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),F=()=>v.connect(P).connect(e.destination),q=()=>{v.disconnect(P),P.disconnect()};return F(),ig(A,()=>{if(E){q(),r.numberOfOutputs>0&&v.connect(y);for(let e=0,i=0;e<r.numberOfOutputs;e+=1){let s=x[e];for(let r=0;r<l[e];r+=1)y.connect(s,i+r,r);i+=l[e]}}V=!0},()=>{E&&(F(),R()),V=!1})}),i4=(tE=(e,i)=>{i1(e).delete(i)},(e,i,s)=>{let r=new WeakMap,a=null;return{render(o,l){tE(l,o);let h=r.get(l);return void 0!==h?Promise.resolve(h):(async(o,l)=>{let h=eY(o),u=null,c=eC(h,l),d=Array.isArray(i.outputChannelCount)?i.outputChannelCount:Array.from(i.outputChannelCount);if(null===n4){let e=d.reduce((e,i)=>e+i,0),s=nb(l,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),r=[];for(let e=0;e<o.numberOfOutputs;e+=1)r.push(iv(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:d[e]}));let a=nS(l,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});a.connect=i2.bind(null,r),a.disconnect=i3.bind(null,r),u=[s,r,a]}else c||(h=new n4(l,e));if(r.set(l,null===u?h:u[2]),null!==u){if(null===a){if(void 0===s)throw Error("Missing the processor constructor.");if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");let e=o.channelCount*o.numberOfInputs,r=void 0===s.parameterDescriptors?0:s.parameterDescriptors.length,h=e+r,u=async()=>{let s=new nJ(h,128*Math.ceil(o.context.length/128),l.sampleRate),a=[],u=[];for(let e=0;e<i.numberOfInputs;e+=1)a.push(nS(s,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1})),u.push(nb(s,{channelCount:i.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:i.channelCount}));let c=await Promise.all(Array.from(o.parameters.values()).map(async e=>{let i=iw(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await iu(s,e,i.offset),i})),d=iv(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+r)});for(let e=0;e<i.numberOfInputs;e+=1){a[e].connect(u[e]);for(let s=0;s<i.channelCount;s+=1)u[e].connect(d,s,e*i.channelCount+s)}for(let[i,s]of c.entries())s.connect(d,0,e+i),s.start(0);return d.connect(s.destination),await Promise.all(a.map(e=>nH(o,s,e))),iM(s)};a=e5(o,0===h?null:await u(),l,i,d,s,iX)}let e=await a,r=ih(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[h,c,p]=u;null!==e&&(r.buffer=e,r.start(0)),r.connect(h);for(let e=0,i=0;e<o.numberOfOutputs;e+=1){let s=c[e];for(let r=0;r<d[e];r+=1)h.connect(s,i+r,r);i+=d[e]}return p}if(c)for(let[e,i]of o.parameters.entries())await il(l,i,h.parameters.get(e));else for(let[e,i]of o.parameters.entries())await iu(l,i,h.parameters.get(e));return await nH(o,l,h),h})(o,l)}}}),i5=iU?(tR=(e,i)=>{i1(e).add(i)},tN=n5,tV=(e,i,s,r,a,o)=>{var l,h;if(null!==s)try{let i=new s(e,r,o),a=new Map,u=null;if(Object.defineProperties(i,{channelCount:{get:()=>o.channelCount,set:()=>{throw nl()}},channelCountMode:{get:()=>"explicit",set:()=>{throw nl()}},onprocessorerror:{get:()=>u,set:e=>{"function"==typeof u&&i.removeEventListener("processorerror",u),u="function"==typeof e?e:null,"function"==typeof u&&i.addEventListener("processorerror",u)}}}),i.addEventListener=(h=i.addEventListener,(...e)=>{if("processorerror"===e[0]){let i="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==i){let s=a.get(e[1]);void 0!==s?e[1]=s:(e[1]=s=>{"error"===s.type?(Object.defineProperties(s,{type:{value:"processorerror"}}),i(s)):i(new ErrorEvent(e[0],{...s}))},a.set(i,e[1]))}}return h.call(i,"error",e[1],e[2]),h.call(i,...e)}),i.removeEventListener=(l=i.removeEventListener,(...e)=>{if("processorerror"===e[0]){let i=a.get(e[1]);void 0!==i&&(a.delete(e[1]),e[1]=i)}return l.call(i,"error",e[1],e[2]),l.call(i,e[0],e[1],e[2])}),0!==o.numberOfOutputs){let s=nS(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return i.connect(s).connect(e.destination),ig(i,()=>s.disconnect(),()=>s.connect(e.destination))}return i}catch(e){if(11===e.code)throw nM();throw e}if(void 0===a)throw nM();return(e=>{let{port1:i}=new MessageChannel;try{i.postMessage(e)}finally{i.close()}})(o),i6(e,i,a,o)},tP=e=>iY.get(e),tF=e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},()=>1)}),tq=(e,i)=>{i8.set(e,i)},tB=e=>{let{port1:i,port2:s}=new MessageChannel;try{i.postMessage(e)}finally{i.close(),s.close()}},class extends tN{constructor(e,i,s){var r;let a=nQ(e),o=nK(a),l=tF({...e3,...s});tB(l);let h=el.get(a),u=null==h?void 0:h.get(i),c=tV(o||"closed"!==a.state?a:null!==(r=tP(a))&&void 0!==r?r:a,o?null:e.baseLatency,n4,i,u,l);super(e,!0,c,o?i4(i,l,u):null);let d=[];c.parameters.forEach((e,i)=>{let s=ic(this,o,e);d.push([i,s])}),this._nativeAudioWorkletNode=c,this._onprocessorerror=null,this._parameters=new e2(d),o&&tR(a,this);let{activeInputs:p}=eI(this);tq(c,p)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){let i="function"==typeof e?nU(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=i;let s=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==s&&s===i?e:s}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}):void 0,i9=(tW=i$,tj=(e,i,s)=>{if(null===nJ)throw Error("Missing the native OfflineAudioContext constructor.");try{return new nJ(e,i,s)}catch(e){if("SyntaxError"===e.name)throw nM();throw e}},tz=(e,i)=>n$(e).render(e,i).then(()=>Promise.all(Array.from(i1(i)).map(e=>n$(e).render(e,i)))).then(()=>iM(i)).then(e=>("function"!=typeof e.copyFromChannel?(ii(e),ek(e)):nY(eA,()=>eA(e))||is(e),n7.add(e),e)),class extends tW{constructor(e,i,s){let r;if("number"==typeof e&&void 0!==i&&void 0!==s)r={length:i,numberOfChannels:e,sampleRate:s};else{if("object"!=typeof e)throw Error("The given parameters are not valid.");r=e}let{length:a,numberOfChannels:o,sampleRate:l}={...nD,...r},h=tj(o,a,l);nY(np,()=>np(h))||h.addEventListener("statechange",(()=>{let e=0,i=s=>{"running"===this._state&&(e>0?(h.removeEventListener("statechange",i),s.stopImmediatePropagation(),this._waitForThePromiseToSettle(s)):e+=1)};return i})()),super(h,o),this._length=a,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(nl()):(this._state="running",tz(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,eN(this)}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}}),i7=e=>n3(er.get(e))||n3(e),st=e=>en.has(e)||n8(e),se=e=>es.has(e)||n6(e),sn=e=>nK(er.get(e))||nK(e);function si(e){return void 0===e}function ss(e){return void 0!==e}function sr(e){return"number"==typeof e}function sa(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function so(e){return Array.isArray(e)}function sl(e){return"string"==typeof e}function sh(e,i){if(!e)throw Error(i)}function su(e,i,s=1/0){if(!(i<=e&&e<=s))throw RangeError(`Value must be within [${i}, ${s}], got: ${e}`)}function sc(e){e.isOffline||"running"===e.state||sm('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let sd=!1,sp=!1,sf=console;function sm(...e){sf.warn(...e)}let s_="object"==typeof self?self:null,sg=s_&&(s_.hasOwnProperty("AudioContext")||s_.hasOwnProperty("webkitAudioContext"));function sv(e,i,s,r){var a,o=arguments.length,l=o<3?i:null===r?r=Object.getOwnPropertyDescriptor(i,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,i,s,r);else for(var h=e.length-1;h>=0;h--)(a=e[h])&&(l=(o<3?a(l):o>3?a(i,s,l):a(i,s))||l);return o>3&&l&&Object.defineProperty(i,s,l),l}function sy(e,i,s,r){return new(s||(s=Promise))(function(a,o){function l(e){try{u(r.next(e))}catch(e){o(e)}}function h(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var i;e.done?a(e.value):((i=e.value)instanceof s?i:new s(function(e){e(i)})).then(l,h)}u((r=r.apply(e,i||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class sx{constructor(e,i,s,r){this._callback=e,this._type=i,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){let e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),i=new Worker(URL.createObjectURL(e));i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var i;this._updateInterval=Math.max(e,this._minimumUpdateInterval),"worker"===this._type&&(null===(i=this._worker)||void 0===i||i.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function sw(e,...i){if(!i.length)return e;let s=i.shift();if(sa(e)&&sa(s))for(let i in s){var r;(r=s[i],"value"===i||se(r)||st(r)||r instanceof ir)?e[i]=s[i]:sa(s[i])?(e[i]||Object.assign(e,{[i]:{}}),sw(e[i],s[i])):Object.assign(e,{[i]:s[i]})}return sw(e,...i)}function sT(e,i,s=[],r){let a={},o=Array.from(i);if(sa(o[0])&&r&&!Reflect.has(o[0],r)&&(Object.keys(o[0]).some(i=>Reflect.has(e,i))||(sw(a,{[r]:o[0]}),s.splice(s.indexOf(r),1),o.shift())),1===o.length&&sa(o[0]))sw(a,o[0]);else for(let e=0;e<s.length;e++)ss(o[e])&&(a[s[e]]=o[e]);return sw(e,a)}/**
     * Tone.js
     * @author Yotam Mann
     * @license http://opensource.org/licenses/MIT MIT License
     * @copyright 2014-2024 Yotam Mann
     */class sb{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||s_&&this.toString()===s_.TONE_DEBUG_CLASS)&&function(...e){sf.log(...e)}(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}function sC(e,i){return e>i+1e-6}function sA(e,i){return sC(e,i)||sk(e,i)}function sS(e,i){return e+1e-6<i}function sk(e,i){return 1e-6>Math.abs(e-i)}sb.version=tL;class sO extends sb{constructor(){super(),this.name="Timeline",this._timeline=[];let e=sT(sO.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(sh(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){let i=this._timeline[this.length-1];sh(sA(e.time,i.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{let i=this._search(e.time);this._timeline.splice(i+1,0,e)}if(this.length>this.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(e){let i=this._timeline.indexOf(e);return -1!==i&&this._timeline.splice(i,1),this}get(e,i="time"){let s=this._search(e,i);return -1!==s?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,i="time"){let s=this._search(e,i);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(e){let i=this._timeline.length;if(i>0&&this._timeline[i-1].time<e)return this._timeline[i-1];let s=this._search(e);return s-1>=0?this._timeline[s-1]:null}cancel(e){if(this._timeline.length>1){let i=this._search(e);if(i>=0){if(sk(this._timeline[i].time,e)){for(let s=i;s>=0&&sk(this._timeline[s].time,e);s--)i=s;this._timeline=this._timeline.slice(0,i)}else this._timeline=this._timeline.slice(0,i+1)}else this._timeline=[]}else 1===this._timeline.length&&sA(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){let i=this._search(e);return i>=0&&(this._timeline=this._timeline.slice(i+1)),this}previousEvent(e){let i=this._timeline.indexOf(e);return i>0?this._timeline[i-1]:null}_search(e,i="time"){if(0===this._timeline.length)return -1;let s=0,r=this._timeline.length,a=r;if(r>0&&this._timeline[r-1][i]<=e)return r-1;for(;s<a;){let r=Math.floor(s+(a-s)/2),o=this._timeline[r],l=this._timeline[r+1];if(sk(o[i],e)){for(let s=r;s<this._timeline.length&&sk(this._timeline[s][i],e);s++)r=s;return r}if(sS(o[i],e)&&sC(l[i],e))return r;sC(o[i],e)?a=r:s=r+1}return -1}_iterate(e,i=0,s=this._timeline.length-1){this._timeline.slice(i,s+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,i){let s=this._search(e);return -1!==s&&this._iterate(i,0,s),this}forEachAfter(e,i){let s=this._search(e);return this._iterate(i,s+1),this}forEachBetween(e,i,s){let r=this._search(e),a=this._search(i);return -1!==r&&-1!==a?(this._timeline[r].time!==e&&(r+=1),this._timeline[a].time===i&&(a-=1),this._iterate(s,r,a)):-1===r&&this._iterate(s,0,a),this}forEachFrom(e,i){let s=this._search(e);for(;s>=0&&this._timeline[s].time>=e;)s--;return this._iterate(i,s+1),this}forEachAtTime(e,i){let s=this._search(e);if(-1!==s&&sk(this._timeline[s].time,e)){let r=s;for(let i=s;i>=0&&sk(this._timeline[i].time,e);i--)r=i;this._iterate(e=>{i(e)},r,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}let sM=[];function sD(e){sM.push(e)}let sI=[];function sE(e){sI.push(e)}class sR extends sb{constructor(){super(...arguments),this.name="Emitter"}on(e,i){return e.split(/\W+/).forEach(e=>{si(this._events)&&(this._events={}),this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(i)}),this}once(e,i){let s=(...r)=>{i(...r),this.off(e,s)};return this.on(e,s),this}off(e,i){return e.split(/\W+/).forEach(e=>{if(si(this._events)&&(this._events={}),this._events.hasOwnProperty(e)){if(si(i))this._events[e]=[];else{let s=this._events[e];for(let e=s.length-1;e>=0;e--)s[e]===i&&s.splice(e,1)}}}),this}emit(e,...i){if(this._events&&this._events.hasOwnProperty(e)){let s=this._events[e].slice(0);for(let e=0,r=s.length;e<r;e++)s[e].apply(this,i)}return this}static mixin(e){["on","once","off","emit"].forEach(i=>{let s=Object.getOwnPropertyDescriptor(sR.prototype,i);Object.defineProperty(e.prototype,i,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class sN extends sR{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class sV extends sN{constructor(){var e,i;super(),this.name="Context",this._constants=new Map,this._timeouts=new sO,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;let s=sT(sV.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=(null===(e=arguments[0])||void 0===e?void 0:e.latencyHint)||""):(this._context=new i0({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new sx(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null===(i=arguments[0])||void 0===i?void 0:i.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var e;return this._initialized||(e=this,sM.forEach(i=>i(e)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,i,s){return this._context.createBuffer(e,i,s)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,i){return this._context.createIIRFilter(e,i)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,i,s){return this._context.createPeriodicWave(e,i,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return sh(i7(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return sh(i7(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return sh(i7(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){sh(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){sh(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){sh(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){sh(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,i){var s;return s=this.rawContext,sh(ss(i5),"AudioWorkletNode only works in a secure context (https or localhost)"),new(s instanceof(null==s_?void 0:s_.BaseAudioContext)?null==s_?void 0:s_.AudioWorkletNode:i5)(s,e,i)}addAudioWorkletModule(e){return sy(this,void 0,void 0,function*(){sh(ss(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return sy(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return i7(this._context)?this._context.resume():Promise.resolve()}close(){return sy(this,void 0,void 0,function*(){var e;i7(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(e=this,sI.forEach(i=>i(e)))})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{let i=this._context.createBuffer(1,128,this._context.sampleRate),s=i.getChannelData(0);for(let i=0;i<s.length;i++)s[i]=e;let r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=i,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){let e=this.now(),i=this._timeouts.peek();for(;this._timeouts.length&&i&&i.time<=e;)i.callback(),this._timeouts.shift(),i=this._timeouts.peek()}setTimeout(e,i){this._timeoutIds++;let s=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:s+i}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(i=>{i.id===e&&this._timeouts.remove(i)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,i){let s=++this._timeoutIds,r=()=>{let a=this.now();this._timeouts.add({callback:()=>{e(),r()},id:s,time:a+i})};return r(),s}}function sP(e,i){so(i)?i.forEach(i=>sP(e,i)):Object.defineProperty(e,i,{enumerable:!0,writable:!1})}let sF=()=>{};class sq extends sb{constructor(){super(),this.name="ToneAudioBuffer",this.onload=sF;let e=sT(sq.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,sl(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:sF,onload:sF,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:sz().sampleRate}set(e){return e instanceof sq?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return sy(this,void 0,void 0,function*(){let i=sq.load(e).then(e=>{this.set(e),this.onload(this)});sq.downloads.push(i);try{yield i}finally{let e=sq.downloads.indexOf(i);sq.downloads.splice(e,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){let i=so(e)&&e[0].length>0,s=i?e.length:1,r=i?e[0].length:e.length,a=sz(),o=a.createBuffer(s,r,a.sampleRate),l=i||1!==s?e:[e];for(let e=0;e<s;e++)o.copyToChannel(l[e],e);return this._buffer=o,this}toMono(e){if(sr(e))this.fromArray(this.toArray(e));else{let e=new Float32Array(this.length),i=this.numberOfChannels;for(let s=0;s<i;s++){let i=this.toArray(s);for(let s=0;s<i.length;s++)e[s]+=i[s]}e=e.map(e=>e/i),this.fromArray(e)}return this}toArray(e){if(sr(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);{let e=[];for(let i=0;i<this.numberOfChannels;i++)e[i]=this.getChannelData(i);return e}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,i=this.duration){sh(this.loaded,"Buffer is not loaded");let s=Math.floor(e*this.sampleRate),r=Math.floor(i*this.sampleRate);sh(s<r,"The start time must be less than the end time");let a=sz().createBuffer(this.numberOfChannels,r-s,this.sampleRate);for(let e=0;e<this.numberOfChannels;e++)a.copyToChannel(this.getChannelData(e).subarray(s,r),e);return new sq(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return(new sq).fromArray(e)}static fromUrl(e){return sy(this,void 0,void 0,function*(){let i=new sq;return yield i.load(e)})}static load(e){return sy(this,void 0,void 0,function*(){let i=e.match(/\[([^\]\[]+\|.+)\]$/);if(i){let s=i[1].split("|"),r=s[0];for(let e of s)if(sq.supportsType(e)){r=e;break}e=e.replace(i[0],r)}let s=""===sq.baseUrl||sq.baseUrl.endsWith("/")?sq.baseUrl:sq.baseUrl+"/",r=document.createElement("a");r.href=s+e,r.pathname=(r.pathname+r.hash).split("/").map(encodeURIComponent).join("/");let a=yield fetch(r.href);if(!a.ok)throw Error(`could not load url: ${e}`);let o=yield a.arrayBuffer();return yield sz().decodeAudioData(o)})}static supportsType(e){let i=e.split("."),s=i[i.length-1];return""!==document.createElement("audio").canPlayType("audio/"+s)}static loaded(){return sy(this,void 0,void 0,function*(){for(yield Promise.resolve();sq.downloads.length;)yield sq.downloads[0]})}}sq.baseUrl="",sq.downloads=[];class sB extends sV{constructor(){var e,i,s,r,a,o;super({clockSource:"offline",context:(r=arguments[0],sn(r))?arguments[0]:(e=arguments[0],i=arguments[1]*arguments[2],s=arguments[2],new i9(e,i,s)),lookAhead:0,updateInterval:(a=arguments[0],sn(a))?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,o=arguments[0],this._duration=sn(o)?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return sy(this,void 0,void 0,function*(){let i=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,i++;let s=Math.floor(this.sampleRate/128);e&&i%s==0&&(yield new Promise(e=>setTimeout(e,1)))}})}render(){return sy(this,arguments,void 0,function*(e=!0){return yield this.workletsAreReady(),yield this._renderClock(e),new sq((yield this._context.startRendering()))})}close(){return Promise.resolve()}}let sW=new class extends sN{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,i,s){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,i){return{}}createPanner(){return{}}createPeriodicWave(e,i,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,i){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return sy(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,i){return 0}clearTimeout(e){return this}setInterval(e,i){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}},sj=sW;function sz(){return sj===sW&&sg&&sL(new sV),sj}function sL(e,i=!1){i&&sj.dispose(),sj=i7(e)?new sV(e):sn(e)?new sB(e):e}function sU(){return sj.resume()}if(s_&&!s_.TONE_SILENCE_LOGGING){let e=` * Tone.js v${tL} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function sX(e,i,s){return Math.min(Math.max(e,i),s)}function sY(e){return Math.pow(10,e/20)}function sZ(e){return Math.log(e)/Math.LN10*20}function sG(e){return Math.pow(2,e/12)}let s$=440;function sH(e){return Math.round(69+12*Math.log2(e/s$))}class sQ extends sb{constructor(e,i,s){super(),this.defaultUnits="s",this._val=i,this._units=s,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,i)=>{let s=parseInt(e,10),r="."===i?1.5:1;return 1===s?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/s)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{let i=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(i)))},regexp:/^(\d+)t$/i},tr:{method:(e,i,s)=>{let r=0;return e&&"0"!==e&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),i&&"0"!==i&&(r+=this._beatsToUnits(parseFloat(i))),s&&"0"!==s&&(r+=this._beatsToUnits(parseFloat(s)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof sQ&&this.fromType(this._val),si(this._val))return this._noArg();if(sl(this._val)&&si(this._units)){for(let e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(sa(this._val)){let e=0;for(let i in this._val)if(ss(this._val[i])){let s=this._val[i];e+=new this.constructor(this.context,i).valueOf()*s}return e}if(ss(this._units)){let e=this._expressions[this._units],i=this._val.toString().trim().match(e.regexp);return i?e.method.apply(this,i.slice(1)):e.method.call(this,this._val)}return sl(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class sJ extends sQ{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{let i=new sJ(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(i))},regexp:/^@(.+)/}})}quantize(e,i=1){let s=new this.constructor(this.context,e).valueOf(),r=this.valueOf();return r+(Math.round(r/s)*s-r)*i}toNotation(){let e=this.toSeconds(),i=["1m"];for(let e=1;e<9;e++){let s=Math.pow(2,e);i.push(s+"n."),i.push(s+"n"),i.push(s+"t")}i.push("0");let s=i[0],r=new sJ(this.context,i[0]).toSeconds();return i.forEach(i=>{let a=new sJ(this.context,i).toSeconds();Math.abs(a-e)<Math.abs(r-e)&&(s=i,r=a)}),s}toBarsBeatsSixteenths(){let e=this._beatsToUnits(1),i=this.valueOf()/e,s=Math.floor((i=parseFloat(i.toFixed(4)))/this._getTimeSignature()),r=i%1*4;i=Math.floor(i)%this._getTimeSignature();let a=r.toString();return a.length>3&&(r=parseFloat(parseFloat(a).toFixed(3))),[s,i,r].join(":")}toTicks(){let e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return sH(this.toFrequency())}_now(){return this.context.now()}}class sK extends sJ{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return s$}static set A4(e){s$=e}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:sK.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,i){let s=s0[e.toLowerCase()]+12*(parseInt(i,10)+1);return"midi"===this.defaultUnits?s:sK.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,i,s){let r=1;return e&&"0"!==e&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),i&&"0"!==i&&(r*=this._beatsToUnits(parseFloat(i))),s&&"0"!==s&&(r*=this._beatsToUnits(parseFloat(s)/4)),r}}})}transpose(e){return new sK(this.context,this.valueOf()*sG(e))}harmonize(e){return e.map(e=>this.transpose(e))}toMidi(){return sH(this.valueOf())}toNote(){let e=Math.round(12*Math.log2(this.toFrequency()/sK.A4))+57,i=Math.floor(e/12);return i<0&&(e+=-12*i),s1[e%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let e=this._beatsToUnits(1);return Math.floor(this.valueOf()/e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return s$*Math.pow(2,(e-69)/12)}static ftom(e){return sH(e)}}let s0={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},s1=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class s2 extends sJ{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class s3 extends sb{constructor(){super();let e=sT(s3.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:sz()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return si(e)&&sd&&!sp&&(sp=!0,sm("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing")),new sJ(this.context,e).toSeconds()}toFrequency(e){return new sK(this.context,e).toFrequency()}toTicks(e){return new s2(this.context,e).toTicks()}_getPartialProperties(e){let i=this.get();return Object.keys(i).forEach(s=>{si(e[s])&&delete i[s]}),i}get(){let e=this.constructor.getDefaults();return Object.keys(e).forEach(i=>{if(Reflect.has(this,i)){let s=this[i];ss(s)&&ss(s.value)&&ss(s.setValueAtTime)?e[i]=s.value:s instanceof s3?e[i]=s._getPartialProperties(e[i]):so(s)||sr(s)||sl(s)||"boolean"==typeof s?e[i]=s:delete e[i]}}),e}set(e){return Object.keys(e).forEach(i=>{Reflect.has(this,i)&&ss(this[i])&&(this[i]&&ss(this[i].value)&&ss(this[i].setValueAtTime)?this[i].value!==e[i]&&(this[i].value=e[i]):this[i]instanceof s3?this[i].set(e[i]):this[i]=e[i])}),this}}class s8 extends s3{constructor(){let e=sT(s8.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,sh(ss(e.param)&&(se(e.param)||e.param instanceof s8),"param must be an AudioParam");!se(e.param);)e.param=e.param._param;this._swappable=!!ss(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new sO(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,ss(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(s3.getDefaults(),{convert:!0,units:"number"})}get value(){let e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return ss(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return ss(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,i){return this.units===i}_assertRange(e){return ss(this.maxValue)&&ss(this.minValue)&&su(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?sY(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?sZ(e):e}setValueAtTime(e,i){let s=this.toSeconds(i),r=this._fromType(e);return sh(isFinite(r)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(i)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,s),this._events.add({time:s,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,s),this}getValueAtTime(e){let i=Math.max(this.toSeconds(e),0),s=this._events.getAfter(i),r=this._events.get(i),a=this._initialValue;if(null===r)a=this._initialValue;else if("setTargetAtTime"!==r.type||null!==s&&"setValueAtTime"!==s.type){if(null===s)a=r.value;else if("linearRampToValueAtTime"===s.type||"exponentialRampToValueAtTime"===s.type){let e=r.value;if("setTargetAtTime"===r.type){let i=this._events.getBefore(r.time);e=null===i?this._initialValue:i.value}a="linearRampToValueAtTime"===s.type?this._linearInterpolate(r.time,e,s.time,s.value,i):this._exponentialInterpolate(r.time,e,s.time,s.value,i)}else a=r.value}else{let e;let s=this._events.getBefore(r.time);e=null===s?this._initialValue:s.value,"setTargetAtTime"===r.type&&(a=this._exponentialApproach(r.time,e,r.value,r.constant,i))}return this._toType(a)}setRampPoint(e){e=this.toSeconds(e);let i=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(i)&&(i=this._toType(this._minOutput)),this.setValueAtTime(i,e),this}linearRampToValueAtTime(e,i){let s=this._fromType(e),r=this.toSeconds(i);return sh(isFinite(s)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(i)}`),this._assertRange(s),this._events.add({time:r,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(s,r),this}exponentialRampToValueAtTime(e,i){let s=this._fromType(e);s=sk(s,0)?this._minOutput:s,this._assertRange(s);let r=this.toSeconds(i);return sh(isFinite(s)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(i)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(s,r),this}exponentialRampTo(e,i,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(e,s+this.toSeconds(i)),this}linearRampTo(e,i,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(e,s+this.toSeconds(i)),this}targetRampTo(e,i,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(e,s,i),this}exponentialApproachValueAtTime(e,i,s){i=this.toSeconds(i);let r=Math.log((s=this.toSeconds(s))+1)/Math.log(200);return this.setTargetAtTime(e,i,r),this.cancelAndHoldAtTime(i+.9*s),this.linearRampToValueAtTime(e,i+s),this}setTargetAtTime(e,i,s){let r=this._fromType(e);sh(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");let a=this.toSeconds(i);return this._assertRange(r),sh(isFinite(r)&&isFinite(a),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(i)}`),this._events.add({constant:s,time:a,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,a,s),this._param.setTargetAtTime(r,a,s),this}setValueCurveAtTime(e,i,s,r=1){s=this.toSeconds(s),i=this.toSeconds(i);let a=this._fromType(e[0])*r;this.setValueAtTime(this._toType(a),i);let o=s/(e.length-1);for(let s=1;s<e.length;s++){let a=this._fromType(e[s])*r;this.linearRampToValueAtTime(this._toType(a),i+s*o)}return this}cancelScheduledValues(e){let i=this.toSeconds(e);return sh(isFinite(i),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(i),this._param.cancelScheduledValues(i),this.log(this.units,"cancelScheduledValues",i),this}cancelAndHoldAtTime(e){let i=this.toSeconds(e),s=this._fromType(this.getValueAtTime(i));sh(isFinite(i),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",i,"value="+s);let r=this._events.get(i),a=this._events.getAfter(i);return r&&sk(r.time,i)?a?(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time)):(this._param.cancelAndHoldAtTime(i),this._events.cancel(i+this.sampleTime)):a&&(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time),"linearRampToValueAtTime"===a.type?this.linearRampToValueAtTime(this._toType(s),i):"exponentialRampToValueAtTime"===a.type&&this.exponentialRampToValueAtTime(this._toType(s),i)),this._events.add({time:i,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,i),this}rampTo(e,i=.1,s){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,i,s):this.linearRampTo(e,i,s),this}apply(e){let i=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(i),i);let s=this._events.get(i);if(s&&"setTargetAtTime"===s.type){let r=this._events.getAfter(s.time),a=r?r.time:i+2,o=(a-i)/10;for(let s=i;s<a;s+=o)e.linearRampToValueAtTime(this.getValueAtTime(s),s)}return this._events.forEachAfter(this.context.currentTime,i=>{"cancelScheduledValues"===i.type?e.cancelScheduledValues(i.time):"setTargetAtTime"===i.type?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){sh(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let i=this.input;return i.disconnect(this._param),this.apply(e),this._param=e,i.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,i,s,r,a){return s+(i-s)*Math.exp(-(a-e)/r)}_linearInterpolate(e,i,s,r,a){return i+(a-e)/(s-e)*(r-i)}_exponentialInterpolate(e,i,s,r,a){return i*Math.pow(r/i,(a-e)/(s-e))}}class s6 extends s3{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return ss(this.input)?se(this.input)||this.input instanceof s8?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ss(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return ss(e)&&(e instanceof s6||st(e))}_getInternalNodes(){let e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(i=>{i.channelCount=e.channelCount,i.channelCountMode=e.channelCountMode,i.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){let e=this._getInternalNodes();sh(e.length>0,"ToneAudioNode does not have any internal nodes");let i=e[0];return{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){let i=this._getChannelProperties();this._setChannelProperties(Object.assign(i,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){let i=this._getChannelProperties();this._setChannelProperties(Object.assign(i,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){let i=this._getChannelProperties();this._setChannelProperties(Object.assign(i,{channelInterpretation:e}))}connect(e,i=0,s=0){return s5(this,e,i,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return sm("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,i=0,s=0){return s9(this,e,i,s),this}chain(...e){return s4(this,...e),this}fan(...e){return e.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),ss(this.input)&&(this.input instanceof s6?this.input.dispose():st(this.input)&&this.input.disconnect()),ss(this.output)&&(this.output instanceof s6?this.output.dispose():st(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function s4(...e){let i=e.shift();e.reduce((e,i)=>(e instanceof s6?e.connect(i):st(e)&&s5(e,i),i),i)}function s5(e,i,s=0,r=0){for(sh(ss(e),"Cannot connect from undefined node"),sh(ss(i),"Cannot connect to undefined node"),(i instanceof s6||st(i))&&sh(i.numberOfInputs>0,"Cannot connect to node with no inputs"),sh(e.numberOfOutputs>0,"Cannot connect from node with no outputs");i instanceof s6||i instanceof s8;)ss(i.input)&&(i=i.input);for(;e instanceof s6;)ss(e.output)&&(e=e.output);se(i)?e.connect(i,s):e.connect(i,s,r)}function s9(e,i,s=0,r=0){if(ss(i))for(;i instanceof s6;)i=i.input;for(;!st(e);)ss(e.output)&&(e=e.output);se(i)?e.disconnect(i,s):st(i)?e.disconnect(i,s,r):e.disconnect()}class s7 extends s6{constructor(){let e=sT(s7.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new s8({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),sP(this,"gain")}static getDefaults(){return Object.assign(s6.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class rt extends s6{constructor(e){super(e),this.onended=sF,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new s7({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let i=this.toSeconds(e);return -1!==this._startTime&&i>=this._startTime&&(-1===this._stopTime||i<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(s6.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:sF})}_startGain(e,i=1){sh(-1===this._startTime,"Source cannot be started more than once");let s=this.toSeconds(this._fadeIn);return this._startTime=e+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(i,e+s):this._gainNode.gain.exponentialApproachValueAtTime(i,e,s)):this._gainNode.gain.setValueAtTime(i,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){sh(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let i=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+i,this._stopTime=Math.max(this._stopTime,this.now()),i>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,i,e):this._gainNode.gain.targetRampTo(0,i,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let e="exponential"===this._curve?2*i:0;this._stopSource(this.now()+e),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==sF&&(this.onended(this),this.onended=sF,!this.context.isOffline)){let e=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),sh(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=sF,this}}class re extends rt{constructor(){let e=sT(re.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),s5(this._source,this._gainNode),this.offset=new s8({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(rt.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){let i=this.toSeconds(e);return this.log("start",i),this._startGain(i),this._source.start(i),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class rn extends s6{constructor(){let e=sT(rn.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new re({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(s6.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,i=0,s=0){return ri(this,e,i,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,i){return this._param.setValueAtTime(e,i),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,i){return this._param.linearRampToValueAtTime(e,i),this}exponentialRampToValueAtTime(e,i){return this._param.exponentialRampToValueAtTime(e,i),this}exponentialRampTo(e,i,s){return this._param.exponentialRampTo(e,i,s),this}linearRampTo(e,i,s){return this._param.linearRampTo(e,i,s),this}targetRampTo(e,i,s){return this._param.targetRampTo(e,i,s),this}exponentialApproachValueAtTime(e,i,s){return this._param.exponentialApproachValueAtTime(e,i,s),this}setTargetAtTime(e,i,s){return this._param.setTargetAtTime(e,i,s),this}setValueCurveAtTime(e,i,s,r){return this._param.setValueCurveAtTime(e,i,s,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,i,s){return this._param.rampTo(e,i,s),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function ri(e,i,s,r){(i instanceof s8||se(i)||i instanceof rn&&i.override)&&(i.cancelScheduledValues(0),i.setValueAtTime(0,0),i instanceof rn&&(i.overridden=!0)),s5(e,i,s,r)}class rs extends s6{constructor(){let e=sT(rs.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new s7({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,sP(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(s6.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class rr extends s6{constructor(){let e=sT(rr.getDefaults(),arguments);super(e),this.name="Destination",this.input=new rs({context:this.context}),this.output=new s7({context:this.context}),this.volume=this.input.volume,s4(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(s6.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),s4(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}sD(e=>{e.destination=new rr({context:e})}),sE(e=>{e.destination.dispose()});class ra extends sb{constructor(e){super(),this.name="TimelineValue",this._timeline=new sO({memory:10}),this._initialValue=e}set(e,i){return this._timeline.add({value:e,time:i}),this}get(e){let i=this._timeline.get(e);return i?i.value:this._initialValue}}class ro extends s6{constructor(){super(sT(ro.getDefaults(),arguments,["context"]))}connect(e,i=0,s=0){return ri(this,e,i,s),this}}class rl extends ro{constructor(){let e=sT(rl.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,so(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):"function"==typeof e.mapping&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(rn.getDefaults(),{length:1024})}setMap(e,i=1024){let s=new Float32Array(i);for(let r=0;r<i;r++){let a=r/(i-1)*2-1;s[r]=e(a,r)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){sh(["none","2x","4x"].some(i=>i.includes(e)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class rh extends ro{constructor(){let e=sT(rh.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new rl({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(ro.getDefaults(),{value:1})}_expFunc(e){return i=>Math.pow(Math.abs(i),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class ru extends s2{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class rc extends sb{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){sh(ss(e.time),"Events must have a time property"),sh(ss(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let i=new rd(e.time,e.time+e.duration,e);for(null===this._root?this._root=i:this._root.insert(i),this._length++;null!==i;)i.updateHeight(),i.updateMax(),this._rebalance(i),i=i.parent;return this}remove(e){if(null!==this._root){let i=[];for(let s of(this._root.search(e.time,i),i))if(s.event===e){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,e=>this.remove(e)),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,i){null!==e.parent?(e.isLeftChild()?e.parent.left=i:e.parent.right=i,this._rebalance(e.parent)):this._setRoot(i)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let i,s=null;if(e.getBalance()>0){if(null===e.left.right)(i=e.left).right=e.right,s=i;else{for(i=e.left.right;null!==i.right;)i=i.right;i.parent&&(i.parent.right=i.left,s=i.parent,i.left=e.left,i.right=e.right)}}else if(null===e.right.left)(i=e.right).left=e.left,s=i;else{for(i=e.right.left;null!==i.left;)i=i.left;i.parent&&(i.parent.left=i.right,s=i.parent,i.left=e.left,i.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=i:e.parent.right=i:this._setRoot(i),s&&this._rebalance(s)}e.dispose()}_rotateLeft(e){let i=e.parent,s=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),null!==i?s?i.left=r:i.right=r:this._setRoot(r)}_rotateRight(e){let i=e.parent,s=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),null!==i?s?i.left=r:i.right=r:this._setRoot(r)}_rebalance(e){let i=e.getBalance();i>1&&e.left?0>e.left.getBalance()?this._rotateLeft(e.left):this._rotateRight(e):i<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){let i=[];if(this._root.search(e,i),i.length>0){let e=i[0];for(let s=1;s<i.length;s++)i[s].low>e.low&&(e=i[s]);return e.event}}return null}forEach(e){if(null!==this._root){let i=[];this._root.traverse(e=>i.push(e)),i.forEach(i=>{i.event&&e(i.event)})}return this}forEachAtTime(e,i){if(null!==this._root){let s=[];this._root.search(e,s),s.forEach(e=>{e.event&&i(e.event)})}return this}forEachFrom(e,i){if(null!==this._root){let s=[];this._root.searchAfter(e,s),s.forEach(e=>{e.event&&i(e.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class rd{constructor(e,i,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=e,this.high=i,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,i){e>this.max||(null!==this.left&&this.left.search(e,i),this.low<=e&&this.high>e&&i.push(this),this.low>e||null!==this.right&&this.right.search(e,i))}searchAfter(e,i){this.low>=e&&(i.push(this),null!==this.left&&this.left.searchAfter(e,i)),null!==this.right&&this.right.searchAfter(e,i)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class rp extends sO{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){let i=this.get(e);return null!==i?i.state:this._initial}setStateAtTime(e,i,s){return su(i,0),this.add(Object.assign({},s,{state:e,time:i})),this}getLastState(e,i){for(let s=this._search(i);s>=0;s--){let i=this._timeline[s];if(i.state===e)return i}}getNextState(e,i){let s=this._search(i);if(-1!==s)for(let i=s;i<this._timeline.length;i++){let s=this._timeline[i];if(s.state===e)return s}}}class rf extends s8{constructor(){let e=sT(rf.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new sO(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(s8.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,i,s){i=this.toSeconds(i),this.setRampPoint(i);let r=this._fromType(e),a=this._events.get(i),o=Math.round(Math.max(1/s,1));for(let e=0;e<=o;e++){let o=s*e+i,l=this._exponentialApproach(a.time,a.value,r,s,o);this.linearRampToValueAtTime(this._toType(l),o)}return this}setValueAtTime(e,i){let s=this.toSeconds(i);super.setValueAtTime(e,i);let r=this._events.get(s),a=this._events.previousEvent(r),o=this._getTicksUntilEvent(a,s);return r.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,i){let s=this.toSeconds(i);super.linearRampToValueAtTime(e,i);let r=this._events.get(s),a=this._events.previousEvent(r),o=this._getTicksUntilEvent(a,s);return r.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,i){i=this.toSeconds(i);let s=this._fromType(e),r=this._events.get(i),a=Math.round(Math.max(10*(i-r.time),1)),o=(i-r.time)/a;for(let e=0;e<=a;e++){let a=o*e+r.time,l=this._exponentialInterpolate(r.time,r.value,i,s,a);this.linearRampToValueAtTime(this._toType(l),a)}return this}_getTicksUntilEvent(e,i){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(si(e.ticks)){let i=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(i,e.time)}let s=this._fromType(this.getValueAtTime(e.time)),r=this._fromType(this.getValueAtTime(i)),a=this._events.get(i);return a&&a.time===i&&"setValueAtTime"===a.type&&(r=this._fromType(this.getValueAtTime(i-this.sampleTime))),.5*(i-e.time)*(s+r)+e.ticks}getTicksAtTime(e){let i=this.toSeconds(e),s=this._events.get(i);return Math.max(this._getTicksUntilEvent(s,i),0)}getDurationOfTicks(e,i){let s=this.toSeconds(i),r=this.getTicksAtTime(i);return this.getTimeOfTick(r+e)-s}getTimeOfTick(e){let i=this._events.get(e,"ticks"),s=this._events.getAfter(e,"ticks");if(i&&i.ticks===e)return i.time;if(i&&s&&"linearRampToValueAtTime"===s.type&&i.value!==s.value){let r=this._fromType(this.getValueAtTime(i.time)),a=(this._fromType(this.getValueAtTime(s.time))-r)/(s.time-i.time),o=Math.sqrt(Math.pow(r,2)-2*a*(i.ticks-e)),l=(-r+o)/a;return(l>0?l:(-r-o)/a)+i.time}return i?0===i.value?1/0:i.time+(e-i.ticks)/i.value:e/this._initialValue}ticksToTime(e,i){return this.getDurationOfTicks(e,i)}timeToTicks(e,i){let s=this.toSeconds(i),r=this.toSeconds(e),a=this.getTicksAtTime(s);return this.getTicksAtTime(s+r)-a}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){let i=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(i,0)}}class rm extends rn{constructor(){let e=sT(rm.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new rf({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(rn.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,i){return this._param.ticksToTime(e,i)}timeToTicks(e,i){return this._param.timeToTicks(e,i)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,i){return this._param.getDurationOfTicks(e,i)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class r_ extends s3{constructor(){let e=sT(r_.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new rp,this._tickOffset=new sO,this._ticksAtTime=new sO,this._secondsAtTime=new sO,this.frequency=new rm({context:this.context,units:e.units,value:e.frequency}),sP(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},s3.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,i){let s=this.toSeconds(e);return"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),ss(i)&&this.setTicksAtTime(i,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(e){let i=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(i)){let e=this._state.get(i);e&&e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(i),this._state.setStateAtTime("stopped",i),this.setTicksAtTime(0,i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i),this}pause(e){let i=this.toSeconds(e);return"started"===this._state.getValueAtTime(i)&&(this._state.setStateAtTime("paused",i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){let i=this.toSeconds(e),s=this._state.getLastState("stopped",i),r=this._ticksAtTime.get(i),a={state:"paused",time:i};this._state.add(a);let o=r||s,l=r?r.ticks:0,h=null;return this._state.forEachBetween(o.time,i+this.sampleTime,e=>{let i=o.time,s=this._tickOffset.get(e.time);s&&s.time>=o.time&&(l=s.ticks,i=s.time),"started"===o.state&&"started"!==e.state&&(l+=this.frequency.getTicksAtTime(e.time)-this.frequency.getTicksAtTime(i),e.time!==a.time&&(h={state:e.state,time:e.time,ticks:l})),o=e}),this._state.remove(a),h&&this._ticksAtTime.add(h),l}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){let i=this.now(),s=this.frequency.timeToTicks(e,i);this.setTicksAtTime(s,i)}getSecondsAtTime(e){e=this.toSeconds(e);let i=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);let r=this._secondsAtTime.get(e),a=r||i,o=r?r.seconds:0,l=null;return this._state.forEachBetween(a.time,e+this.sampleTime,e=>{let i=a.time,r=this._tickOffset.get(e.time);r&&r.time>=a.time&&(o=r.seconds,i=r.time),"started"===a.state&&"started"!==e.state&&(o+=e.time-i,e.time!==s.time&&(l={state:e.state,time:e.time,seconds:o})),a=e}),this._state.remove(s),l&&this._secondsAtTime.add(l),o}setTicksAtTime(e,i){return i=this.toSeconds(i),this._tickOffset.cancel(i),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,i),ticks:e,time:i}),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,i=this.now()){let s=this._tickOffset.get(i),r=this._state.get(i),a=Math.max(s.time,r.time),o=this.frequency.getTicksAtTime(a)+e-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,i,s){let r=this._state.get(e);this._state.forEachBetween(e,i,i=>{r&&"started"===r.state&&"started"!==i.state&&this.forEachTickBetween(Math.max(r.time,e),i.time-this.sampleTime,s),r=i});let a=null;if(r&&"started"===r.state){let o=Math.max(r.time,e),l=this.frequency.getTicksAtTime(o),h=l-this.frequency.getTicksAtTime(r.time),u=Math.ceil(h)-h;u=sk(u,1)?0:u;let c=this.frequency.getTimeOfTick(l+u);for(;c<i;){try{s(c,Math.round(this.getTicksAtTime(c)))}catch(e){a=e;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(a)throw a;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class rg extends s3{constructor(){let e=sT(rg.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=sF,this._lastUpdate=0,this._state=new rp("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new r_({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,sP(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(s3.getDefaults(),{callback:sF,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,i){sc(this.context);let s=this.toSeconds(e);return this.log("start",s),"started"!==this._state.getValueAtTime(s)&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,i),s<this._lastUpdate&&this.emit("start",s,i)),this}stop(e){let i=this.toSeconds(e);return this.log("stop",i),this._state.cancel(i),this._state.setStateAtTime("stopped",i),this._tickSource.stop(i),i<this._lastUpdate&&this.emit("stop",i),this}pause(e){let i=this.toSeconds(e);return"started"===this._state.getValueAtTime(i)&&(this._state.setStateAtTime("paused",i),this._tickSource.pause(i),i<this._lastUpdate&&this.emit("pause",i)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,i){return this._tickSource.setTicksAtTime(e,i),this}getTimeOfTick(e,i=this.now()){return this._tickSource.getTimeOfTick(e,i)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,i){let s=this.toSeconds(i),r=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(r+e,s)}_loop(){let e=this._lastUpdate,i=this.now();this._lastUpdate=i,this.log("loop",e,i),e!==i&&(this._state.forEachBetween(e,i,e=>{switch(e.state){case"started":let i=this._tickSource.getTicksAtTime(e.time);this.emit("start",e.time,i);break;case"stopped":0!==e.time&&this.emit("stop",e.time);break;case"paused":this.emit("pause",e.time)}}),this._tickSource.forEachTickBetween(e,i,(e,i)=>{this.callback(e,i)}))}getStateAtTime(e){let i=this.toSeconds(e);return this._state.getValueAtTime(i)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}sR.mixin(rg);class rv{constructor(e,i){this.id=rv._eventId++,this._remainderTime=0;let s=Object.assign(rv.getDefaults(),i);this.transport=e,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:sF,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){let i=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*i),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}rv._eventId=0;class ry extends rv{constructor(e,i){super(e,i),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let s=Object.assign(ry.getDefaults(),i);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},rv.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return sS(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new ru(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){sS(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ru(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;let i=this.transport.getTicksAtTime(e);sC(i,this.time)&&(this._nextTick=this.floatTime+Math.ceil((i-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class rx extends s3{constructor(){let e=sT(rx.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new ra(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new sO,this._repeatedEvents=new rc,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new rg({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),sP(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(s3.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,i){if(this._loop.get(e)&&i>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),i=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&i%this._ppq!=0&&i%(2*this._swingTicks)!=0){let s=Math.sin(i%(2*this._swingTicks)/(2*this._swingTicks)*Math.PI)*this._swingAmount;e+=new ru(this.context,2*this._swingTicks/3).toSeconds()*s}sd=!0,this._timeline.forEachAtTime(i,i=>i.invoke(e)),sd=!1}schedule(e,i){let s=new rv(this,{callback:e,time:new s2(this.context,i).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(e,i,s,r=1/0){let a=new ry(this,{callback:e,duration:new sJ(this.context,r).toTicks(),interval:new sJ(this.context,i).toTicks(),time:new s2(this.context,s).toTicks()});return this._addEvent(a,this._repeatedEvents)}scheduleOnce(e,i){let s=new rv(this,{callback:e,once:!0,time:new s2(this.context,i).toTicks()});return this._addEvent(s,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){let i=this._scheduledEvents[e.toString()];i.timeline.remove(i.event),i.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,i){return this._scheduledEvents[e.id.toString()]={event:e,timeline:i},i.add(e),e.id}cancel(e=0){let i=this.toTicks(e);return this._timeline.forEachFrom(i,e=>this.clear(e.id)),this._repeatedEvents.forEachFrom(i,e=>this.clear(e.id)),this}_bindClockEvents(){this._clock.on("start",(e,i)=>{i=new ru(this.context,i).toSeconds(),this.emit("start",e,i)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,i){let s;return this.context.resume(),ss(i)&&(s=this.toTicks(i)),this._clock.start(e,s),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){so(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new sJ(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new sJ(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,i){return this.loopStart=e,this.loopEnd=i,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new ru(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){let e=this.now(),i=this._clock.getTicksAtTime(e);return new ru(this.context,i).toBarsBeatsSixteenths()}set position(e){let i=this.toTicks(e);this.ticks=i}get seconds(){return this._clock.seconds}set seconds(e){let i=this.now(),s=this._clock.frequency.timeToTicks(e,i);this.ticks=s}get progress(){if(this.loop){let e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){let i=this.now();if("started"===this.state){let s=this._clock.getTicksAtTime(i),r=i+this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,i);this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",i),this._clock.setTicksAtTime(e,i)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{let i=this.now(),s=e-this.getTicksAtTime(i)%e;return this._clock.nextTickTime(s,i)}}syncSignal(e,i){let s=this.now(),r=this.bpm,a=1/(60/r.getValueAtTime(s)/this.PPQ),o=[];if("time"===e.units){let e=1/64/a,i=new s7(e),s=new rh(-1),l=new s7(e);r.chain(i,s,l),r=l,a=1/a,o=[i,s,l]}i||(i=0!==e.getValueAtTime(s)?e.getValueAtTime(s)/a:0);let l=new s7(i);return r.connect(l),l.connect(e._param),o.push(l),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let i=this._syncedSignals.length-1;i>=0;i--){let s=this._syncedSignals[i];s.signal===e&&(s.nodes.forEach(e=>e.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(i,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),function e(i,s){so(s)?s.forEach(s=>e(i,s)):Object.defineProperty(i,s,{writable:!0})}(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}sR.mixin(rx),sD(e=>{e.transport=new rx({context:e})}),sE(e=>{e.transport.dispose()});class rw extends s6{constructor(e){super(e),this.input=void 0,this._state=new rp("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=sF,this._syncedStop=sF,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new rs({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,sP(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(s6.getDefaults(),{mute:!1,onstop:sF,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,i,s){let r=si(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),this._synced||"started"!==this._state.getValueAtTime(r)){if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){let e=this._state.get(r);e&&(e.offset=this.toSeconds(si(i)?0:i),e.duration=s?this.toSeconds(s):void 0);let a=this.context.transport.schedule(e=>{this._start(e,i,s)},r);this._scheduled.push(a),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else sc(this.context),this._start(r,i,s)}else sh(sC(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,i,s);return this}stop(e){let i=si(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),"started"===this._state.getValueAtTime(i)||ss(this._state.getNextState("started",i))){if(this.log("stop",i),this._synced){let e=this.context.transport.schedule(this._stop.bind(this),i);this._scheduled.push(e)}else this._stop(i);this._state.cancel(i),this._state.setStateAtTime("stopped",i)}return this}restart(e,i,s){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,i,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,i)=>{if(sC(i,0)){let s=this._state.get(i);if(s&&"started"===s.state&&s.time!==i){let r;let a=i-this.toSeconds(s.time);s.duration&&(r=this.toSeconds(s.duration)-a),this._start(e,this.toSeconds(s.offset)+a,r)}}},this._syncedStop=e=>{let i=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(i)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=sF,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class rT extends rt{constructor(){let e=sT(rT.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],s5(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new s8({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new s8({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),sP(this,["frequency","detune"])}static getDefaults(){return Object.assign(rt.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){let i=this.toSeconds(e);return this.log("start",i),this._startGain(i),this._oscillator.start(i),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class rb extends rw{constructor(){let e=sT(rb.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new rn({context:this.context,units:"frequency",value:e.frequency}),sP(this,"frequency"),this.detune=new rn({context:this.context,units:"cents",value:e.detune}),sP(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&"custom"!==e.type&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(rw.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){let i=this.toSeconds(e),s=new rT({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(i)}_stop(e){let i=this.toSeconds(e);this._oscillator&&this._oscillator.stop(i)}_restart(e){let i=this.toSeconds(e);return this.log("restart",i),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(i),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return rb._periodicWaveCache.find(e=>{var i,s;return e.phase===this._phase&&(i=e.partials,s=this._partials,i.length===s.length&&i.every((e,i)=>s[i]===e))});{let e=rb._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;let i=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&i)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{let i=this._getCachedPeriodicWave();if(ss(i)){let{partials:e,wave:s}=i;this._wave=s,this._partials=e,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[i,s]=this._getRealImaginary(e,this._phase),r=this.context.createPeriodicWave(i,s);this._wave=r,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),rb._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),rb._periodicWaveCache.length>100&&rb._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){su(e,0);let i=this._type,s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(i=s[1]),"custom"!==this._type)this.type=0===e?i:i+e.toString();else{let i=new Float32Array(e);this._partials.forEach((e,s)=>i[s]=e),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,i){let s=2048,r=new Float32Array(2048),a=new Float32Array(s),o=1;if("custom"===e){if(o=this._partials.length+1,this._partialCount=this._partials.length,s=o,0===this._partials.length)return[r,a]}else{let i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);i?(o=parseInt(i[2],10)+1,this._partialCount=parseInt(i[2],10),e=i[1],s=o=Math.max(o,2)):this._partialCount=0,this._partials=[]}for(let l=1;l<s;++l){let s;let h=2/(l*Math.PI);switch(e){case"sine":s=+(l<=o),this._partials[l-1]=s;break;case"square":s=1&l?2*h:0,this._partials[l-1]=s;break;case"sawtooth":s=h*(1&l?1:-1),this._partials[l-1]=s;break;case"triangle":s=1&l?h*h*2*(l-1>>1&1?-1:1):0,this._partials[l-1]=s;break;case"custom":s=this._partials[l-1];break;default:throw TypeError("Oscillator: invalid type: "+e)}0!==s?(r[l]=-s*Math.sin(i*l),a[l]=s*Math.cos(i*l)):(r[l]=0,a[l]=0)}return[r,a]}_inverseFFT(e,i,s){let r=0,a=e.length;for(let o=0;o<a;o++)r+=e[o]*Math.cos(o*s)+i[o]*Math.sin(o*s);return r}getInitialValue(){let[e,i]=this._getRealImaginary(this._type,0),s=0,r=2*Math.PI;for(let a=0;a<32;a++)s=Math.max(this._inverseFFT(e,i,a/32*r),s);return Math.max(Math.min(-this._inverseFFT(e,i,this._phase)/s,1),-1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return sy(this,arguments,void 0,function*(e=1024){return function(e,i){return sy(this,void 0,void 0,function*(){let s=i/e.context.sampleRate,r=new sB(1,s,e.context.sampleRate);return new e.constructor(Object.assign(e.get(),{frequency:2/s,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}(this,e)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}rb._periodicWaveCache=[];class rC{constructor(e=440,i="sine"){if("string"==typeof e&&"string"==typeof i){let s=e;e=440,i=s}if("string"==typeof e&&"number"==typeof i){let s=i;i=e,e=s}this.frequency=e,this.type=i,this.osc=(new rb).toDestination(),this.osc.frequency.value=this.frequency,this.osc.type=this.type,this.osc.volume.value=-6}freq(e,i=0){this.osc.frequency.rampTo(sX(e,0,24e3),i)}phase(e){this.osc.phase=e}setType(e){this.osc.type=e}amp(e,i=.1){if("object"==typeof e)return void e.getNode().connect(this.osc.volume);let s=sZ(e);this.osc.volume.rampTo(s,i)}start(){this.osc.start()}stop(){this.osc.stop()}connect(e){"function"==typeof e.getNode?this.osc.connect(e.getNode()):this.osc.connect(e)}disconnect(){this.osc.disconnect(sV.destination)}getNode(){return this.osc}}function rA(e,i=1/0){let s=new WeakMap;return function(r,a){Reflect.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(r){su(this.toSeconds(r),e,i),s.set(this,r)}})}}class rS extends s6{constructor(){let e=sT(rS.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new rn({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(s6.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,i){if(sl(e))return e;{let s;for(s in rk)if(rk[s][i]===e)return s;return e}}_setCurve(e,i,s){if(sl(s)&&Reflect.has(rk,s)){let r=rk[s];sa(r)?"_decayCurve"!==e&&(this[e]=r[i]):this[e]=r}else{if(!so(s)||"_decayCurve"===e)throw Error("Envelope: invalid curve: "+s);this[e]=s}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,i=1){this.log("triggerAttack",e,i),e=this.toSeconds(e);let s=this.toSeconds(this.attack),r=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0&&(s=(1-a)/(1/s)),s<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(i,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(i,s,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(i,s,e);else{this._sig.cancelAndHoldAtTime(e);let r=this._attackCurve;for(let e=1;e<r.length;e++)if(r[e-1]<=a&&a<=r[e]){(r=this._attackCurve.slice(e))[0]=a;break}this._sig.setValueCurveAtTime(r,e,s,i)}if(r&&this.sustain<1){let a=i*this.sustain,o=e+s;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(a,r+o):this._sig.exponentialApproachValueAtTime(a,o,r)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);let i=this.getValueAtTime(e);if(i>0){let s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,s,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,s,e):(sh(so(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,s,i))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,i,s=1){return i=this.toSeconds(i),this.triggerAttack(i,s),this.triggerRelease(i+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,i=0,s=0){return ri(this,e,i,s),this}asArray(){return sy(this,arguments,void 0,function*(e=1024){let i=e/this.context.sampleRate,s=new sB(1,i,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),a=r+this.toSeconds(this.release),o=.1*a,l=a+o,h=new this.constructor(Object.assign(this.get(),{attack:i*this.toSeconds(this.attack)/l,decay:i*this.toSeconds(this.decay)/l,release:i*this.toSeconds(this.release)/l,context:s}));return h._sig.toDestination(),h.triggerAttackRelease(i*(r+o)/l,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}sv([rA(0)],rS.prototype,"attack",void 0),sv([rA(0)],rS.prototype,"decay",void 0),sv([function(e,i=1/0){let s=new WeakMap;return function(e,r){Reflect.defineProperty(e,r,{configurable:!0,enumerable:!0,get:function(){return s.get(this)},set:function(e){su(e,0,i),s.set(this,e)}})}}(0,1)],rS.prototype,"sustain",void 0),sv([rA(0)],rS.prototype,"release",void 0);let rk=(()=>{let e,i;let s=[];for(e=0;e<128;e++)s[e]=Math.sin(e/127*(Math.PI/2));let r=[];for(e=0;e<127;e++){let s=Math.sin(2*Math.PI*(i=e/127)*6.4-Math.PI/2)+1;r[e]=s/10+.83*i}r[127]=1;let a=[];for(e=0;e<128;e++)a[e]=Math.ceil(e/127*5)/5;let o=[];for(e=0;e<128;e++)i=e/127,o[e]=.5*(1-Math.cos(Math.PI*i));let l=[];for(e=0;e<128;e++){let s=Math.cos((4*Math.pow(i=e/127,3)+.2)*Math.PI*2*i);l[e]=Math.abs(s*(1-i))}function h(e){let i=Array(e.length);for(let s=0;s<e.length;s++)i[s]=1-e[s];return i}return{bounce:{In:h(l),Out:l},cosine:{In:s,Out:s.slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:r,Out:h(r)},sine:{In:o,Out:h(o)},step:{In:a,Out:h(a)}}})();class rO extends rS{constructor(){super(sT(rO.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new s7({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}var rM,rD,rI,rE,rR,rN,rV,rP,rF,rq,rB=class{constructor(e=.1,i=.12,s=.1,r=.2){this.attack=e,this.attackLevel=1,this.decay=i,this.sustain=s,this.release=r,this.envelope=new rO({attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release}).toDestination()}play(){this.envelope.triggerAttackRelease(this.sustain)}triggerAttack(){this.envelope.triggerAttack()}triggerRelease(){this.envelope.triggerRelease()}setInput(e){e.getNode().connect(this.envelope)}setADSR(e,i,s,r){this.envelope.attack=e,this.envelope.decay=i,this.envelope.sustain=s,this.envelope.release=r}releaseTime(e){this.envelope.release=e}attackTime(e){this.envelope.attack=e}connect(e){this.envelope.connect(e.getNode())}disconnect(){this.envelope.disconnect(sV.destination)}getNode(){return this.envelope}};class rW extends s6{constructor(){let e=sT(rW.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";let i=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(i,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(i),this.delayTime=new s8({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),sP(this,"delayTime")}static getDefaults(){return Object.assign(s6.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class rj extends ro{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new rl({context:this.context,mapping:e=>2*Math.abs(e)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class rz extends s6{constructor(){let e=sT(rz.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new rj({context:this.context}),this.a=new s7({context:this.context,gain:0}),this.b=new s7({context:this.context,gain:0}),this.output=new s7({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new rn({context:this.context,units:"normalRange",value:e.fade}),sP(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",s5(this._split,this.a.gain,0),s5(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(s6.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class rL extends s6{constructor(e){super(e),this.name="Effect",this._dryWet=new rz({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new s7({context:this.context}),this.effectReturn=new s7({context:this.context}),this.input=new s7({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],sP(this,"wet")}static getDefaults(){return Object.assign(s6.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class rU extends rL{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new s7({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,sP(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(rL.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class rX extends rU{constructor(){let e=sT(rX.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new rW({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),sP(this,"delayTime")}static getDefaults(){return Object.assign(rU.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}var rY=class{constructor(e=.25,i=.2){this.d=e,this.f=i,this.delay=new rX(this.d,this.f).toDestination()}delayTime(e,i=.1){0!=i?this.delay.delayTime.rampTo(sX(e,0,1),i):this.delay.delayTime.value=sX(e,0,1)}feedback(e){this.delay.feedback.rampTo(sX(e,0,.99),.1)}process(e,i,s){this.delay.delayTime.value=i,this.delay.feedback.value=s,e.getNode().connect(this.delay)}amp(e){let i=sZ(e);this.delay.volume.rampTo(i,.1)}getNode(){return this.delay}connect(e){"function"==typeof e.getNode?this.delay.connect(e.getNode()):this.delay.connect(e)}disconnect(){this.delay.disconnect(sV.destination)}};class rZ extends s6{constructor(){let e=sT(rZ.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(s6.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class rG extends rt{constructor(){let e=sT(rG.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,s5(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new s8({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new sq(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(rt.getDefaults(),{url:new sq,loop:!1,loopEnd:0,loopStart:0,onload:sF,onerror:sF,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,i,s,r=1){var a,o,l;sh(this.buffer.loaded,"buffer is either not set or not loaded");let h=this.toSeconds(e);this._startGain(h,r),i=this.loop?(a=i,o=this.loopStart,si(a)?o:a):si(l=i)?0:l;let u=Math.max(this.toSeconds(i),0);if(this.loop){let e=this.toSeconds(this.loopEnd)||this.buffer.duration,i=this.toSeconds(this.loopStart),s=e-i;sA(u,e)&&(u=(u-i)%s+i),sk(u,this.buffer.duration)&&(u=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,sS(u,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(h,u)),ss(s)){let e=this.toSeconds(s);e=Math.max(e,0),this.stop(h+e)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class r$ extends rw{constructor(){let e=sT(r$.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(rw.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(sh(e in rQ,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){let e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){let i=rQ[this._type];this._source=new rG({url:i,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(i.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}let rH={brown:null,pink:null,white:null},rQ={get brown(){if(!rH.brown){let e=[];for(let i=0;i<2;i++){let s=new Float32Array(220500);e[i]=s;let r=0;for(let e=0;e<220500;e++){let i=2*Math.random()-1;s[e]=(r+.02*i)/1.02,r=s[e],s[e]*=3.5}}rH.brown=(new sq).fromArray(e)}return rH.brown},get pink(){if(!rH.pink){let e=[];for(let i=0;i<2;i++){let s,r,a,o,l,h,u;let c=new Float32Array(220500);e[i]=c,s=r=a=o=l=h=u=0;for(let e=0;e<220500;e++){let i=2*Math.random()-1;s=.99886*s+.0555179*i,r=.99332*r+.0750759*i,a=.969*a+.153852*i,o=.8665*o+.3104856*i,l=.55*l+.5329522*i,h=-.7616*h-.016898*i,c[e]=s+r+a+o+l+h+u+.5362*i,c[e]*=.11,u=.115926*i}}rH.pink=(new sq).fromArray(e)}return rH.pink},get white(){if(!rH.white){let e=[];for(let i=0;i<2;i++){let s=new Float32Array(220500);e[i]=s;for(let e=0;e<220500;e++)s[e]=2*Math.random()-1}rH.white=(new sq).fromArray(e)}return rH.white}};class rJ extends rL{constructor(){let e=sT(rJ.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve(),this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(rL.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){su(e=this.toSeconds(e),.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){su(e=this.toSeconds(e),0),this._preDelay=e,this.generate()}generate(){return sy(this,void 0,void 0,function*(){let e=this.ready,i=new sB(2,this._decay+this._preDelay,this.context.sampleRate),s=new r$({context:i}),r=new r$({context:i}),a=new rZ({context:i});s.connect(a,0,0),r.connect(a,0,1);let o=new s7({context:i}).toDestination();a.connect(o),s.start(0),r.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let l=i.render();return this.ready=l.then(sF),yield e,this._convolver.buffer=(yield l).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}var rK=class{constructor(e){this.decayTime=e||1,this.reverb=new rJ(this.decayTime).toDestination()}set(e){this.reverb.decay=e}drywet(e){this.reverb.wet.value=e}connect(e){"function"==typeof e.getNode?this.reverb.connect(e.getNode()):this.reverb.connect(e)}disconnect(){this.reverb.disconnect(sV.destination)}getNode(){return this.reverb}};class r0 extends s6{constructor(){let e=sT(r0.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new s8({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new s8({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new s8({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new s8({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(s6.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){sh(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){let i=new Float32Array(e);for(let s=0;s<e;s++){let r=19980*Math.pow(s/e,2)+20;i[s]=r}let s=new Float32Array(e),r=new Float32Array(e),a=this.context.createBiquadFilter();return a.type=this.type,a.Q.value=this.Q.value,a.frequency.value=this.frequency.value,a.gain.value=this.gain.value,a.getFrequencyResponse(i,s,r),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class r1{constructor(e=800,i="lowpass"){this.type=i,this.cutoff=e,this.biquad=new r0(this.cutoff,this.type).toDestination()}res(e){this.biquad.Q.value=e}gain(e){this.biquad.gain.value=e}setType(e){this.biquad.type=e}freq(e){this.biquad.frequency.value=sX(e,0,24e3)}connect(e){"function"==typeof e.getNode?this.biquad.connect(e.getNode()):this.biquad.connect(e)}disconnect(){this.biquad.disconnect(sV.destination)}getNode(){return this.biquad}}class r2 extends ro{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new rl({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class r3 extends rn{constructor(){super(sT(r3.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new s7({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,s4(this._constantSource,this._sum)}static getDefaults(){return Object.assign(rn.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class r8 extends rn{constructor(){let e=sT(r8.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new s7({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(rn.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class r6 extends ro{constructor(){let e=sT(r6.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new r8({context:this.context,value:e.max-e.min}),this._add=this.output=new r3({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(ro.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class r4 extends ro{constructor(){super(sT(r4.getDefaults(),arguments)),this.name="Zero",this._gain=new s7({context:this.context}),this.output=this._gain,this.input=void 0,s5(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),s9(this.context.getConstant(0),this._gain),this}}class r5 extends s6{constructor(){let e=sT(r5.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=s8.prototype._fromType,this._toType=s8.prototype._toType,this._is=s8.prototype._is,this._clampValue=s8.prototype._clampValue,this._oscillator=new rb(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new s7({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new rn({context:this.context,units:"audioRange",value:0}),this._zeros=new r4({context:this.context}),this._a2g=new r2({context:this.context}),this._scaler=this.output=new r6({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),sP(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(rb.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){let i=this.min,s=this.max;this._units=e,this.min=i,this.max=s}get state(){return this._oscillator.state}connect(e,i,s){return(e instanceof s8||e instanceof rn)&&(this.convert=e.convert,this.units=e.units),ri(this,e,i,s),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}class r9 extends rU{constructor(){let e=sT(r9.getDefaults(),arguments,["pitch"]);super(e),this.name="PitchShift",this._frequency=new rn({context:this.context}),this._delayA=new rW({maxDelay:1,context:this.context}),this._lfoA=new r5({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new rW({maxDelay:1,context:this.context}),this._lfoB=new r5({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new rz({context:this.context}),this._crossFadeLFO=new r5({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new rW({delayTime:e.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,sP(this,"delayTime"),this._pitch=e.pitch,this._windowSize=e.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let i=this.now();this._lfoA.start(i),this._lfoB.start(i),this._crossFadeLFO.start(i),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(rU.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(e){this._pitch=e;let i=0;e<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,i=sG(e-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,i=sG(e)-1),this._frequency.value=i*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(e){this._windowSize=this.toSeconds(e),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}var r7=class{constructor(e=1){this.pitchshifter=new r9(e).toDestination()}shift(e){void 0!==e&&(this.pitchshifter.pitch=e)}connect(e){"function"==typeof e.getNode?this.pitchshifter.connect(e.getNode()):this.pitchshifter.connect(e)}disconnect(){this.pitchshifter.disconnect(sV.destination)}getNode(){return this.pitchshifter}},at=class{constructor(e=1){this.gain=new s7(e).toDestination()}amp(e){"object"!=typeof e?this.gain.gain.rampTo(e,.1):e.getNode().connect(this.gain.gain)}connect(e){"function"==typeof e.getNode?this.gain.connect(e.getNode()):this.gain.connect(e)}disconnect(){this.gain.disconnect(sV.destination)}getNode(){return this.gain}};class ae extends s6{constructor(){let e=sT(ae.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(s6.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class an extends s6{constructor(){let e=sT(an.getDefaults(),arguments,["type","size"]);super(e),this.name="Analyser",this._analysers=[],this._buffers=[],this.input=this.output=this._gain=new s7({context:this.context}),this._split=new ae({context:this.context,channels:e.channels}),this.input.connect(this._split),su(e.channels,1);for(let i=0;i<e.channels;i++)this._analysers[i]=this.context.createAnalyser(),this._split.connect(this._analysers[i],i,0);this.size=e.size,this.type=e.type,this.smoothing=e.smoothing}static getDefaults(){return Object.assign(s6.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((e,i)=>{let s=this._buffers[i];"fft"===this._type?e.getFloatFrequencyData(s):"waveform"===this._type&&e.getFloatTimeDomainData(s)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(e){this._analysers.forEach((i,s)=>{i.fftSize=2*e,this._buffers[s]=new Float32Array(e)})}get channels(){return this._analysers.length}get type(){return this._type}set type(e){sh("waveform"===e||"fft"===e,`Analyser: invalid type: ${e}`),this._type=e}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(e){this._analysers.forEach(i=>i.smoothingTimeConstant=e)}dispose(){return super.dispose(),this._analysers.forEach(e=>e.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class ai extends s6{constructor(){super(sT(ai.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new an({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class as extends ai{constructor(){let e=sT(as.getDefaults(),arguments,["smoothing"]);super(e),this.name="Meter",this.input=this.output=this._analyser=new an({context:this.context,size:256,type:"waveform",channels:e.channelCount}),this.smoothing=e.smoothing,this.normalRange=e.normalRange,this._rms=Array(e.channelCount),this._rms.fill(0)}static getDefaults(){return Object.assign(ai.getDefaults(),{smoothing:.8,normalRange:!1,channelCount:1})}getLevel(){return sm("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let e=this._analyser.getValue(),i=(1===this.channels?[e]:e).map((e,i)=>{let s=Math.sqrt(e.reduce((e,i)=>e+i*i,0)/e.length);return this._rms[i]=Math.max(s,this._rms[i]*this.smoothing),this.normalRange?this._rms[i]:sZ(this._rms[i])});return 1===this.channels?i[0]:i}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}var ar=class{constructor(e=0){this.amplitude=new as({normalRange:!0,smoothing:e})}setInput(e){e.getNode().connect(this.amplitude)}getLevel(){return this.amplitude.getValue()}smooth(e){this.amplitude.smoothing=e}connect(e){"function"==typeof e.getNode?this.amplitude.connect(e.getNode()):this.amplitude.connect(e)}disconnect(){this.amplitude.disconnect(sV.destination)}getNode(){return this.amplitude}};class aa extends ai{constructor(){let e=sT(aa.getDefaults(),arguments,["size"]);super(e),this.name="FFT",this.normalRange=e.normalRange,this._analyser.type="fft",this.size=e.size}static getDefaults(){return Object.assign(s6.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(e=>this.normalRange?sY(e):e)}get size(){return this._analyser.size}set size(e){this._analyser.size=e}get smoothing(){return this._analyser.smoothing}set smoothing(e){this._analyser.smoothing=e}getFrequencyOfIndex(e){return sh(0<=e&&e<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),e*this.context.sampleRate/(2*this.size)}}class ao extends ai{constructor(){let e=sT(ao.getDefaults(),arguments,["size"]);super(e),this.name="Waveform",this._analyser.type="waveform",this.size=e.size}static getDefaults(){return Object.assign(ai.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(e){this._analyser.size=e}}var al=class{constructor(e=32){this.fftSize=e,this.analyzer=new aa({size:this.fftSize,normalRange:!0}),this.samples=new ao,this.gain=new s7(1),this.gain.connect(this.analyzer),this.gain.connect(this.samples)}getNode(){return this.gain}analyze(){return this.analyzer.getValue()}waveform(){return this.samples.getValue()}},ah=class{constructor(e){void 0===e&&(e="white"),this.noise=(new r$).toDestination(),this.noise.type=e}type(e){this.noise.type=e}amp(e,i=.1){if("object"==typeof e)return void e.getNode().connect(this.noise.volume);let s=sZ(e);this.noise.volume.rampTo(s,i)}start(){this.noise.start()}stop(){this.noise.stop()}connect(e){"function"==typeof e.getNode?this.noise.connect(e.getNode()):this.noise.connect(e)}disconnect(){this.noise.disconnect(sV.destination)}getNode(){return this.noise}};class au extends s6{constructor(){let e=sT(au.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new s8({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",sP(this,"pan")}static getDefaults(){return Object.assign(s6.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}var ac=class{constructor(){this.panner=new au(0).toDestination()}pan(e){"object"!=typeof e?this.panner.pan.rampTo(sX(e,-1,1),.01):e.getNode().connect(this.panner.pan)}getNode(){return this.panner}connect(e){"function"==typeof e.getNode?this.panner.connect(e.getNode()):this.panner.connect(e)}disconnect(){this.panner.disconnect(sV.destination)}};class ad extends s6{constructor(){super(...arguments),this.name="Listener",this.positionX=new s8({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new s8({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new s8({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new s8({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new s8({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new s8({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new s8({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new s8({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new s8({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(s6.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}sD(e=>{e.listener=new ad({context:e})}),sE(e=>{e.listener.dispose()});class ap extends s6{constructor(){let e=sT(ap.getDefaults(),arguments,["positionX","positionY","positionZ"]);super(e),this.name="Panner3D",this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=e.panningModel,this.maxDistance=e.maxDistance,this.distanceModel=e.distanceModel,this.coneOuterGain=e.coneOuterGain,this.coneOuterAngle=e.coneOuterAngle,this.coneInnerAngle=e.coneInnerAngle,this.refDistance=e.refDistance,this.rolloffFactor=e.rolloffFactor,this.positionX=new s8({context:this.context,param:this._panner.positionX,value:e.positionX}),this.positionY=new s8({context:this.context,param:this._panner.positionY,value:e.positionY}),this.positionZ=new s8({context:this.context,param:this._panner.positionZ,value:e.positionZ}),this.orientationX=new s8({context:this.context,param:this._panner.orientationX,value:e.orientationX}),this.orientationY=new s8({context:this.context,param:this._panner.orientationY,value:e.orientationY}),this.orientationZ=new s8({context:this.context,param:this._panner.orientationZ,value:e.orientationZ})}static getDefaults(){return Object.assign(s6.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(e,i,s){return this.positionX.value=e,this.positionY.value=i,this.positionZ.value=s,this}setOrientation(e,i,s){return this.orientationX.value=e,this.orientationY.value=i,this.orientationZ.value=s,this}get panningModel(){return this._panner.panningModel}set panningModel(e){this._panner.panningModel=e}get refDistance(){return this._panner.refDistance}set refDistance(e){this._panner.refDistance=e}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(e){this._panner.rolloffFactor=e}get distanceModel(){return this._panner.distanceModel}set distanceModel(e){this._panner.distanceModel=e}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(e){this._panner.coneInnerAngle=e}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(e){this._panner.coneOuterAngle=e}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(e){this._panner.coneOuterGain=e}get maxDistance(){return this._panner.maxDistance}set maxDistance(e){this._panner.maxDistance=e}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}var af=class{constructor(){this.panner3d=new ap({coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:1,positionX:0,positionY:0,positionZ:0}).toDestination()}process(e){e.getNode().connect(this.panner3d)}set(e,i,s){this.panner3d.positionX.rampTo(e,.01),this.panner3d.positionY.rampTo(i,.01),this.panner3d.positionZ.rampTo(s,.01)}setFalloff(e,i){this.panner3d.rolloffFactor=e,this.panner3d.maxDistance=i}maxDist(e){this.panner3d.maxDistance=e}rolloff(e){this.panner3d.rolloffFactor=e}positionX(e){this.panner3d.positionX.rampTo(e,.01)}positionY(e){this.panner3d.positionY.rampTo(e,.01)}positionZ(e){this.panner3d.positionZ.rampTo(e,.01)}connect(e){"function"==typeof e.getNode?this.panner3d.connect(e.getNode()):this.panner3d.connect(e)}disconnect(){this.panner3d.disconnect(sV.destination)}getNode(){return this.panner3d}};class am extends rw{constructor(){let e=sT(am.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new sq({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(rw.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:sF,onerror:sF,playbackRate:1,reverse:!1})}load(e){return sy(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=sF){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,i,s){return super.start(e,i,s),this}_start(e,i,s){var r,a,o,l,h;i=this._loop?(r=i,a=this._loopStart,si(r)?a:r):si(o=i)?0:o;let u=this.toSeconds(i),c=s;l=s,h=Math.max(this._buffer.duration-u,0),s=si(l)?h:l;let d=this.toSeconds(s);d/=this._playbackRate,e=this.toSeconds(e);let p=new rG({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+d),this._state.setStateAtTime("stopped",e+d,{implicitEnd:!0})),this._activeSources.add(p),this._loop&&si(c)?p.start(e,u):p.start(e,u,d-this.toSeconds(this.fadeOut))}_stop(e){let i=this.toSeconds(e);this._activeSources.forEach(e=>e.stop(i))}restart(e,i,s){return super.restart(e,i,s),this}_restart(e,i,s){var r;null===(r=[...this._activeSources].pop())||void 0===r||r.stop(e),this._start(e,i,s)}seek(e,i){let s=this.toSeconds(i);if("started"===this._state.getValueAtTime(s)){let i=this.toSeconds(e);this._stop(s),this._start(s,i)}return this}setLoopPoints(e,i){return this.loopStart=e,this.loopEnd=i,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&su(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(i=>{i.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&su(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(i=>{i.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(i=>{i.loop=e}),e)){let e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;let i=this.now(),s=this._state.getNextState("stopped",i);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(e=>e.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(e,i)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}sv([rA(0)],am.prototype,"fadeIn",void 0),sv([rA(0)],am.prototype,"fadeOut",void 0);var a_=class{constructor(e,i){this.soundfile=new am(e,i).toDestination(),this.playing=!1,this.speed=1,this.paused=!1}start(){this.soundfile.playbackRate=this.speed,this.playing=!0,this.paused||this.soundfile.start()}play(){this.soundfile.playbackRate=this.speed,this.playing=!0,this.paused||this.soundfile.start()}stop(){this.soundfile.stop(),this.playing=!1}pause(){this.soundfile.playbackRate=0,this.playing=!1,this.paused=!0}loop(e=!0){this.soundfile.loop=e}loopPoints(e=0,i=this.soundfile.buffer.duration,s=0){this.soundfile.loopStart=e,this.soundfile.loopEnd=e+i}amp(e){let i=sZ(e);this.soundfile.volume.value=i}setPath(e,i){this.soundfile.load(e).then(()=>{i?i():console.log("Audio loaded successfully!")}).catch(e=>{console.error("Error loading audio:",e)})}rate(e=1){e<0&&(e=0),this.soundfile.playbackRate=e,this.speed=e}duration(){return this.soundfile.buffer.duration}sampleRate(){if(this.soundfile.buffer)return this.soundfile.buffer.sampleRate}jump(e){this.soundfile.seek(e)}isPlaying(){return this.playing}isLooping(){return this.soundfile.loop}onended(e){this.soundfile.onstop=e}frames(){if(this.soundfile.buffer)return this.soundfile.buffer.length}sampleRate(){if(this.soundfile.buffer)return this.soundfile.buffer.sampleRate}channels(){if(this.soundfile.buffer)return this.soundfile.buffer.numberOfChannels}connect(e){this.soundfile.connect(e.getNode())}disconnect(){this.soundfile.disconnect(sV.destination)}getNode(){return this.soundfile}};class ag extends s6{constructor(){let e=sT(ag.getDefaults(),arguments,["volume"]);super(e),this.name="UserMedia",this._volume=this.output=new rs({context:this.context,volume:e.volume}),this.volume=this._volume.volume,sP(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(s6.getDefaults(),{mute:!1,volume:0})}open(e){return sy(this,void 0,void 0,function*(){sh(ag.supported,"UserMedia is not supported"),"started"===this.state&&this.close();let i=yield ag.enumerateDevices();sr(e)?this._device=i[e]:(this._device=i.find(i=>i.label===e||i.deviceId===e),!this._device&&i.length>0&&(this._device=i[0]),sh(ss(this._device),`No matching device ${e}`));let s={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(s.audio.deviceId=this._device.deviceId);let r=yield navigator.mediaDevices.getUserMedia(s);if(!this._stream){this._stream=r;let e=this.context.createMediaStreamSource(r);s5(e,this.output),this._mediaStream=e}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(e=>{e.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return sy(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind)})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return ss(navigator.mediaDevices)&&ss(navigator.mediaDevices.getUserMedia)}}var av=class{constructor(){this.audioIn=new ag}start(){sU(),this.audioIn.open().then(()=>{console.log("mic open")}).catch(e=>{console.log("mic not open")})}stop(){this.audioIn.close()}amp(e){let i=sZ(e);this.delay.volume.rampTo(i,.1)}getNode(){return this.audioIn}connect(e){"function"==typeof e.getNode?this.audioIn.connect(e.getNode()):this.audioIn.connect(e)}disconnect(){this.audioIn.disconnect(sV.destination)}};p5.prototype.getAudioContext=function(){return sL(new window.AudioContext),sz()._context},p5.prototype.setAudioContext=function(e){sL(e)},p5.prototype.userStartAudio=function(){sU()},p5.prototype.userStopAudio=function(){(context=sz()).suspend()},p5.Oscillator=rC,p5.SawOsc=class extends rC{constructor(e){super(e),this.osc.type="sawtooth"}},p5.SinOsc=class extends rC{constructor(e){super(e),this.osc.type="sine"}},p5.TriOsc=class extends rC{constructor(e){super(e),this.osc.type="triangle"}},p5.SqrOsc=class extends rC{constructor(e){super(e),this.osc.type="square"}},p5.Envelope=rB,p5.Delay=rY,p5.Reverb=rK,p5.Biquad=r1,p5.LowPass=class extends r1{constructor(e){super(e),this.biquad.type="lowpass"}},p5.HighPass=class extends r1{constructor(e){super(e),this.biquad.type="highpass"}},p5.BandPass=class extends r1{constructor(e){super(e),this.biquad.type="bandpass"}},p5.PitchShifter=r7,p5.Gain=at,p5.Amplitude=ar,p5.FFT=al,p5.Noise=ah,p5.Panner=ac,p5.Panner3D=af,p5.SoundFile=a_,p5.prototype.loadSound=function(e){return self._incrementPreload&&self._decrementPreload?(self._incrementPreload(),new p5.SoundFile(e,function(){self._decrementPreload()})):new Promise(i=>{let s=new p5.SoundFile(e,function(){i(s)})})},p5.AudioIn=av}();
//# sourceMappingURL=index.c3ac1718.js.map
